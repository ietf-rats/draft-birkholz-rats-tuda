<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Time-Based Uni-Directional Attestation</title>
<meta content="Andreas Fuchs" name="author">
<meta content="Henk Birkholz" name="author">
<meta content="Ira E McDonald" name="author">
<meta content="Carsten Bormann" name="author">
<meta content="
       This document defines the method and bindings used to convey Evidence via Time-based Uni-Directional Attestation (TUDA) in Remote ATtestation procedureS (RATS).
TUDA does not require a challenge-response handshake and thereby does not rely on the conveyance of a nonce to prove freshness of remote attestation Evidence.
TUDA enables the creation of Secure Audit Logs that can constitute believable Evidence about both current and past operational states of an Attester.
In TUDA, RATS entities require access to a Handle Distributor to which a trustable and synchronized time-source is available.
The Handle Distributor takes on the role of a Time Stamp Authority (TSA) to distribute Handles incorporating Time Stamp Tokens (TST) to the RATS entities.
RATS require an Attesting Environment that generates believable Evidence.
While a TPM is used as the corresponding root of trust in this specification, any other type of root of trust can be used with TUDA. 
    " name="description">
<meta content="xml2rfc 3.12.10" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-birkholz-rats-tuda-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.10
    Python 3.10.4
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.1
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.8.0
    MarkupSafe 2.0.1
    pycountry 20.7.3
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.27.1
    setuptools 59.4.0
    six 1.16.0
-->
<link href="draft-birkholz-rats-tuda.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
dd.break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href].selfRef {
  color: var(--text-color);
}
a[href] {
  color: var(--link-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: 14.5px;
}
.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 8em;
}
#identifiers dt {
  width: var(--identifier-width);
  margin: 0;
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0 0 0 calc(1em + var(--identifier-width));
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([stroke="fill"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">TUDA</td>
<td class="right">July 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Fuchs, et al.</td>
<td class="center">Expires 11 January 2023</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">RATS Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-birkholz-rats-tuda-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-07-10" class="published">10 July 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2023-01-11">11 January 2023</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">A. Fuchs</div>
<div class="org">Fraunhofer SIT</div>
</div>
<div class="author">
      <div class="author-name">H. Birkholz</div>
<div class="org">Fraunhofer SIT</div>
</div>
<div class="author">
      <div class="author-name">I. McDonald</div>
<div class="org">High North Inc</div>
</div>
<div class="author">
      <div class="author-name">C. Bormann</div>
<div class="org">Universität Bremen TZI</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Time-Based Uni-Directional Attestation</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines the method and bindings used to convey Evidence via Time-based Uni-Directional Attestation (TUDA) in Remote ATtestation procedureS (RATS).
TUDA does not require a challenge-response handshake and thereby does not rely on the conveyance of a nonce to prove freshness of remote attestation Evidence.
TUDA enables the creation of Secure Audit Logs that can constitute believable Evidence about both current and past operational states of an Attester.
In TUDA, RATS entities require access to a Handle Distributor to which a trustable and synchronized time-source is available.
The Handle Distributor takes on the role of a Time Stamp Authority (TSA) to distribute Handles incorporating Time Stamp Tokens (TST) to the RATS entities.
RATS require an Attesting Environment that generates believable Evidence.
While a TPM is used as the corresponding root of trust in this specification, any other type of root of trust can be used with TUDA.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-birkholz-rats-tuda/">https://datatracker.ietf.org/doc/draft-birkholz-rats-tuda/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Remote ATtestation ProcedureS (rats) Working Group mailing list (<span><a href="mailto:rats@ietf.org">mailto:rats@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/rats/">https://mailarchive.ietf.org/arch/browse/rats/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/ietf-rats/draft-birkholz-rats-tuda">https://github.com/ietf-rats/draft-birkholz-rats-tuda</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 11 January 2023.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-forward-authenticity" class="xref">Forward Authenticity</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-tuda-objectives" class="xref">TUDA Objectives</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="xref">1.3</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-remote-attestation-principl" class="xref">Remote Attestation Principles</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-authenticity-of-evidence" class="xref">Authenticity of Evidence</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-generating-evidence-about-s" class="xref">Generating Evidence about Software Component Integrity</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-measurements-and-digests-ge" class="xref">Measurements and Digests Generated by an Attester</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-attesting-environments-and-" class="xref">Attesting Environments and Roots of Trust</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a href="#section-2.5" class="xref">2.5</a>.  <a href="#name-indeterministic-measurement" class="xref">Indeterministic Measurements</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-tuda-principles-and-require" class="xref">TUDA Principles and Requirements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-attesting-environment-requi" class="xref">Attesting Environment Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-handle-distributor-requirem" class="xref">Handle Distributor Requirements: Time Stamp Authority</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-information-elements-and-co" class="xref">Information Elements and Conveyance</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-tuda-core-concept" class="xref">TUDA Core Concept</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-tpm-specific-terms" class="xref">TPM Specific Terms</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-certificates" class="xref">Certificates</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-the-tuda-protocol-family" class="xref">The TUDA Protocol Family</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-tuda-information-elements-u" class="xref">TUDA Information Elements Update Cycles</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-sync-base-protocol" class="xref">Sync Base Protocol</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-contributors" class="xref">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="xref">11.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="xref">11.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-rest-realization" class="xref">REST Realization</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-B" class="xref">Appendix B</a>.  <a href="#name-snmp-realization" class="xref">SNMP Realization</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#appendix-B.1" class="xref">B.1</a>.  <a href="#name-structure-of-tuda-mib" class="xref">Structure of TUDA MIB</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1.2.1">
                    <p id="section-toc.1-1.13.2.1.2.1.1"><a href="#appendix-B.1.1" class="xref">B.1.1</a>.  <a href="#name-cycle-index" class="xref">Cycle Index</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1.2.2">
                    <p id="section-toc.1-1.13.2.1.2.2.1"><a href="#appendix-B.1.2" class="xref">B.1.2</a>.  <a href="#name-instance-index" class="xref">Instance Index</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1.2.3">
                    <p id="section-toc.1-1.13.2.1.2.3.1"><a href="#appendix-B.1.3" class="xref">B.1.3</a>.  <a href="#name-fragment-index" class="xref">Fragment Index</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#appendix-B.2" class="xref">B.2</a>.  <a href="#name-relationship-to-host-resour" class="xref">Relationship to Host Resources MIB</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a href="#appendix-B.3" class="xref">B.3</a>.  <a href="#name-relationship-to-entity-mib" class="xref">Relationship to Entity MIB</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.4">
                <p id="section-toc.1-1.13.2.4.1"><a href="#appendix-B.4" class="xref">B.4</a>.  <a href="#name-relationship-to-other-mibs" class="xref">Relationship to Other MIBs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.5">
                <p id="section-toc.1-1.13.2.5.1"><a href="#appendix-B.5" class="xref">B.5</a>.  <a href="#name-definition-of-tuda-mib" class="xref">Definition of TUDA MIB</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-C" class="xref">Appendix C</a>.  <a href="#name-yang-realization" class="xref">YANG Realization</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-D" class="xref">Appendix D</a>.  <a href="#name-realization-with-tpm-functi" class="xref">Realization with TPM functions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#appendix-D.1" class="xref">D.1</a>.  <a href="#name-tpm-functions" class="xref">TPM Functions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1.2.1">
                    <p id="section-toc.1-1.15.2.1.2.1.1"><a href="#appendix-D.1.1" class="xref">D.1.1</a>.  <a href="#name-tick-session-and-tick-stamp" class="xref">Tick-Session and Tick-Stamp</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1.2.2">
                    <p id="section-toc.1-1.15.2.1.2.2.1"><a href="#appendix-D.1.2" class="xref">D.1.2</a>.  <a href="#name-platform-configuration-regi" class="xref">Platform Configuration Registers (PCRs)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1.2.3">
                    <p id="section-toc.1-1.15.2.1.2.3.1"><a href="#appendix-D.1.3" class="xref">D.1.3</a>.  <a href="#name-pcr-restricted-keys" class="xref">PCR restricted Keys</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1.2.4">
                    <p id="section-toc.1-1.15.2.1.2.4.1"><a href="#appendix-D.1.4" class="xref">D.1.4</a>.  <a href="#name-certifyinfo" class="xref">CertifyInfo</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#appendix-D.2" class="xref">D.2</a>.  <a href="#name-ie-generation-procedures-fo" class="xref">IE Generation Procedures for TPM 1.2</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2.2.1">
                    <p id="section-toc.1-1.15.2.2.2.1.1"><a href="#appendix-D.2.1" class="xref">D.2.1</a>.  <a href="#name-aik-and-aik-certificate" class="xref">AIK and AIK Certificate</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2.2.2">
                    <p id="section-toc.1-1.15.2.2.2.2.1"><a href="#appendix-D.2.2" class="xref">D.2.2</a>.  <a href="#name-synchronization-token" class="xref">Synchronization Token</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2.2.3">
                    <p id="section-toc.1-1.15.2.2.2.3.1"><a href="#appendix-D.2.3" class="xref">D.2.3</a>.  <a href="#name-restrictioninfo" class="xref">RestrictionInfo</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2.2.4">
                    <p id="section-toc.1-1.15.2.2.2.4.1"><a href="#appendix-D.2.4" class="xref">D.2.4</a>.  <a href="#name-measurement-log" class="xref">Measurement Log</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2.2.5">
                    <p id="section-toc.1-1.15.2.2.2.5.1"><a href="#appendix-D.2.5" class="xref">D.2.5</a>.  <a href="#name-implicit-attestation" class="xref">Implicit Attestation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2.2.6">
                    <p id="section-toc.1-1.15.2.2.2.6.1"><a href="#appendix-D.2.6" class="xref">D.2.6</a>.  <a href="#name-attestation-verification-ap" class="xref">Attestation Verification Approach</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.3">
                <p id="section-toc.1-1.15.2.3.1"><a href="#appendix-D.3" class="xref">D.3</a>.  <a href="#name-ie-generation-procedures-for" class="xref">IE Generation Procedures for TPM 2.0</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.3.2.1">
                    <p id="section-toc.1-1.15.2.3.2.1.1"><a href="#appendix-D.3.1" class="xref">D.3.1</a>.  <a href="#name-aik-and-aik-certificate-2" class="xref">AIK and AIK Certificate</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.3.2.2">
                    <p id="section-toc.1-1.15.2.3.2.2.1"><a href="#appendix-D.3.2" class="xref">D.3.2</a>.  <a href="#name-synchronization-token-2" class="xref">Synchronization Token</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.3.2.3">
                    <p id="section-toc.1-1.15.2.3.2.3.1"><a href="#appendix-D.3.3" class="xref">D.3.3</a>.  <a href="#name-measurement-log-2" class="xref">Measurement Log</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.3.2.4">
                    <p id="section-toc.1-1.15.2.3.2.4.1"><a href="#appendix-D.3.4" class="xref">D.3.4</a>.  <a href="#name-explicit-time-based-attesta" class="xref">Explicit time-based Attestation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.3.2.5">
                    <p id="section-toc.1-1.15.2.3.2.5.1"><a href="#appendix-D.3.5" class="xref">D.3.5</a>.  <a href="#name-sync-proof" class="xref">Sync Proof</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-E" class="xref"></a><a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-F" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Remote ATtestation procedureS (RATS) describe the attempt to determine and appraise system properties, such as integrity and trustworthiness, of a remote peer -- the Attester -- by the use of a Verifier in support of Relying Parties that intend to interact with the Attester. The Verifier carries the burden of appraisal of detailed Evidence about an Attester's trustworthiness. Evidence is generated by the Attester and consumed by the Verifier. To support security decisions, the Verifier generates digestable Attestation Results that can be easily consumed by Relying Parties. The RATS architecture specifies the corresponding concepts and terms <span>[<a href="#I-D.ietf-rats-architecture" class="xref">I-D.ietf-rats-architecture</a>]</span>.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">TUDA uses the architectural constituents of the RATS Architecture, such as the roles Attester and Verifier, and defines a method to convey Conceptual Messages between them. TUDA uses the Uni-Directional Remote Attestation interaction model described in <span>[<a href="#I-D.ietf-rats-reference-interaction-models" class="xref">I-D.ietf-rats-reference-interaction-models</a>]</span>. While the Conceptual Message focused on in this document is RATS Evidence, any type of Conceptual Message content that requires a believable indication about the message's content freshness can be conveyed with TUDA (e.g. Attestation Results).<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">The conveyance of Evidence in RATS must ensure that Evidence always remains integrity protected, tamper-evident, originates from a trustable entity (or group of entities), and is accompanied by a proof of its freshness.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">In contrast to bi-directional interactions as described by Challenge/Response Remote Attestation in <span>[<a href="#I-D.ietf-rats-reference-interaction-models" class="xref">I-D.ietf-rats-reference-interaction-models</a>]</span>, TUDA enables uni-directional conveyance in the interactions between Attester and Verifier. TUDA allows a Verifier to receive Evidence from an Attester without solicitation. Conversely, it allows a Verifier to retrieve Evidence from an Attester without it being generated ad-hoc. Exemplary applications of TUDA are the creation of beacons in vehicular environments <span>[<a href="#IEEE1609" class="xref">IEEE1609</a>]</span> or authentication mechanisms based on EAP <span>[<a href="#RFC5247" class="xref">RFC5247</a>]</span>.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">The generation of Evidence in RATS requires an Attesting Environment. In this specification, the root of trust acting as an Attesting Environment is a Trusted Platform Module (TPM, see <span>[<a href="#TPM12" class="xref">TPM12</a>]</span> and <span>[<a href="#TPM2" class="xref">TPM2</a>]</span>). The Protected Capabilities <span>[<a href="#TCGGLOSS" class="xref">TCGGLOSS</a>]</span> provided by a TPM support various activities in RATS, e.g., Claims collection and Evidence generation.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">A trusted coupling of Evidence generation with a global timescale is enabled via a Handle Distributor.
Handles generated by a Handle Distributor can include nonces, signed timestamps, or other structured or opaque content used as qualifying data in Evidence generation.
In TUDA, all RATS entities, such as the entities taking on the roles of Attester and Verifier, can receive signed timestamps from the Handle Distributor.
These trusted timestamps replace nonces in Evidence generation and Evidence appraisal <span>[<a href="#I-D.ietf-rats-reference-interaction-models" class="xref">I-D.ietf-rats-reference-interaction-models</a>]</span>.<a href="#section-1-6" class="pilcrow">¶</a></p>
<div id="forward-authenticity">
<section id="section-1.1">
        <h3 id="name-forward-authenticity">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-forward-authenticity" class="section-name selfRef">Forward Authenticity</a>
        </h3>
<p id="section-1.1-1">Nonces enable an implicit time-keeping in which the freshness of Evidence is inferred by recentness.
Recentness is estimated via the time interval between sending a nonce as part of a challenge for Evidence and the reception of Evidence based on that nonce (as outlined in the interaction model depicted in section 8.1 in <span>[<a href="#I-D.ietf-rats-reference-interaction-models" class="xref">I-D.ietf-rats-reference-interaction-models</a>]</span>).
Conversely, the omission of nonces in TUDA allows for explicit time-keeping where freshness is not inferred from recentness.
Instead, a cryptographic binding of a trusted synchronization to a global timescale in the Evidence itself allows for Evidence that can prove past operational states of an Attester.
To capture and support this concept, this document introduces the term Forward Authenticity.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.1-2">
          <dt id="section-1.1-2.1">Forward Authenticity:</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.2">
            <p id="section-1.1-2.2.1">A property of secure communication protocols, in which later compromise of the long-term keys of a data origin does not compromise past authentication of data from that origin.
Forward Authenticity is achieved by timely recording of authenticity Claims from Target Environments (via "audit logs" during "audit sessions") that are authorized for this purpose and trustworthy (via endorsed roots of trusts, for example), in a time-frame much shorter than that expected for the compromise of the long-term keys.<a href="#section-1.1-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.3"></dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.4">
            <p id="section-1.1-2.4.1">Forward Authenticity enables new levels of assurance and can be included in basically every protocol, such as ssh, YANG Push, router advertisements, link layer neighbor discovery, or even ICMP echo requests.<a href="#section-1.1-2.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="tuda-objectives">
<section id="section-1.2">
        <h3 id="name-tuda-objectives">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-tuda-objectives" class="section-name selfRef">TUDA Objectives</a>
        </h3>
<p id="section-1.2-1">Time-Based Uni-directional Attestation is designed to:<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-2.1">increase the confidence in authentication and authorization procedures,<a href="#section-1.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.2">address the requirements of constrained-node networks,<a href="#section-1.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.3">support interaction models that do not maintain connection-state over time, such as REST architectures <span>[<a href="#REST" class="xref">REST</a>]</span>,<a href="#section-1.2-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.4">be able to leverage existing management interfaces, such as SNMP
(RFC 3411, <span>[<a href="#STD62" class="xref">STD62</a>]</span>). RESTCONF <span>[<a href="#RFC8040" class="xref">RFC8040</a>]</span> or CoMI <span>[<a href="#I-D.ietf-core-comi" class="xref">I-D.ietf-core-comi</a>]</span> --- and corresponding bindings,<a href="#section-1.2-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.5">support broadcast and multicast schemes (e.g. <span>[<a href="#IEEE1609" class="xref">IEEE1609</a>]</span>),<a href="#section-1.2-2.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.6">be able to cope with temporary loss of connectivity, and to<a href="#section-1.2-2.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.7">provide trustworthy audit logs of past endpoint states.<a href="#section-1.2-2.7" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="terminology">
<section id="section-1.3">
        <h3 id="name-terminology">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.3-1">This document uses the terms defined in the RATS Architecture <span>[<a href="#I-D.ietf-rats-architecture" class="xref">I-D.ietf-rats-architecture</a>]</span> and by the RATS Reference Interaction Models <span>[<a href="#I-D.ietf-rats-reference-interaction-models" class="xref">I-D.ietf-rats-reference-interaction-models</a>]</span>.<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<p id="section-1.3-2">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="remote-attestation-principles">
<section id="section-2">
      <h2 id="name-remote-attestation-principl">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-remote-attestation-principl" class="section-name selfRef">Remote Attestation Principles</a>
      </h2>
<p id="section-2-1">Based on the RATS Architecture, the processing of TPM generated Evidence can be separated in three activities.<a href="#section-2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2-2">
        <dt id="section-2-2.1">Evidence Generation:</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.2">
          <p id="section-2-2.2.1">The retrieval of signed digests from an RTR based on a sequence of collected Claims about software component integrity (measurements).<a href="#section-2-2.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.3">Evidence Conveyance:</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.4">
          <p id="section-2-2.4.1">The transfer of Evidence from the Attester to the Verifier via the Internet.<a href="#section-2-2.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.5">Evidence Appraisal:</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.6">
          <p id="section-2-2.6.1">The validation of Evidence signatures as well as the assessment of Claim values in Evidence by comparing them with Reference Values.<a href="#section-2-2.6.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-2-3">TUDA is specified in support of these RATS activities that align with the definitions presented in <span>[<a href="#PRIRA" class="xref">PRIRA</a>]</span> and <span>[<a href="#TCGGLOSS" class="xref">TCGGLOSS</a>]</span>.<a href="#section-2-3" class="pilcrow">¶</a></p>
<div id="authenticity-of-evidence">
<section id="section-2.1">
        <h3 id="name-authenticity-of-evidence">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-authenticity-of-evidence" class="section-name selfRef">Authenticity of Evidence</a>
        </h3>
<p id="section-2.1-1">Remote attestation Evidence is composed of a set of Claims (assertions about the trustworthiness of an Attester's Target Environments) that is accompanied by a proof of its veracity -- typically a signature based on shielded, private, and potentially use-restricted key material used as an Authentication Secret as specified in section 6 of <span>[<a href="#I-D.ietf-rats-reference-interaction-models" class="xref">I-D.ietf-rats-reference-interaction-models</a>]</span> (or a secure channel as illustrated in <span>[<a href="#I-D.birkholz-rats-uccs" class="xref">I-D.birkholz-rats-uccs</a>]</span>).
As key material alone is typically not self-descriptive with respect to its intended use (its semantics), the Evidence created via TUDA <span class="bcp14">MUST</span> be accompanied by two kinds of certificates that are cryptographically associated with a trust anchor (TA) <span>[<a href="#RFC4949" class="xref">RFC4949</a>]</span> via certification paths:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-2.1">an Attestation Key (AK) Certificate (AK-Cert) that represents the attestation provenance of the Attesting Environment (see section 4.2. in <span>[<a href="#I-D.ietf-rats-architecture" class="xref">I-D.ietf-rats-architecture</a>]</span>) that generates Evidence, and<a href="#section-2.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-2.2">an Endorsement Key (EK) Certificate (EK-Cert) that represents the Protection Capabilities of an Attesting Environment the AK is stored in.<a href="#section-2.1-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.1-3">If a Verifier decides to trust the TA of both an AK-Cert and an EK-Cert presented by an Attester -- and thereby the included Claims about the trustworthiness of an Attester's Target Environments -- the Evidence generated by the Attester can be considered trustable and believable.
Ultimately, all trustable and believable Evidence <span class="bcp14">MUST</span> be appraised by a Verifier in order to assess the trustworthiness of the corresponding Attester.
Assertions represented via Claims <span class="bcp14">MUST NOT</span> be considered believable by themselves.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4">In this document, Evidence is generated via TPMs that come with an AK-Cert and a EK-Cert as a basis for believable Evidence generation.<a href="#section-2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="generating-evidence-about-software-component-integrity">
<section id="section-2.2">
        <h3 id="name-generating-evidence-about-s">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-generating-evidence-about-s" class="section-name selfRef">Generating Evidence about Software Component Integrity</a>
        </h3>
<p id="section-2.2-1">Evidence generated by a TPM for TUDA is based on measured hash values of all software components deployed in Target Environments (see section 4.2. in <span>[<a href="#I-D.ietf-rats-architecture" class="xref">I-D.ietf-rats-architecture</a>]</span>) before they are executed ("measure then execute").
The underlying concept of "Attestation Logs" is elaborated on in Section 2.4.2. of <span>[<a href="#I-D.fedorkow-rats-network-device-attestation" class="xref">I-D.fedorkow-rats-network-device-attestation</a>]</span>.
This concept is implemented, for example, in the Linux kernel where it is called the Linux Integrity Measurement Architecture (IMA) <span>[<a href="#Safford" class="xref">Safford</a>]</span> and used to generates such a sequence of hash values.
A representation for conveyance of corresponding event logs is described in the Canonical Event Log <span>[<a href="#CEL" class="xref">CEL</a>]</span> specification.
Open source solutions, for example, based on <span>[<a href="#RFC5209" class="xref">RFC5209</a>]</span> use an IMA log to enable remote attestation <span>[<a href="#Steffens" class="xref">Steffens</a>]</span>.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">An Attester <span class="bcp14">MUST</span> generate such an event/measurement log.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="measurements-and-digests-generated-by-an-attester">
<section id="section-2.3">
        <h3 id="name-measurements-and-digests-ge">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-measurements-and-digests-ge" class="section-name selfRef">Measurements and Digests Generated by an Attester</a>
        </h3>
<p id="section-2.3-1">A hash value of a software component is created before it is executed by Attesters.
These hash values are typically represented as event log entries referred to as measurements, which often occur in large quantities.
Capabilities such as Linux IMA can be used to generate these measurements on an Attester.
Measurements are chained by Attesters using a rolling hash function.
A TPM acts as a root of trust for storage (RTS) by providing an Extend (<span>[<a href="#TPM12" class="xref">TPM12</a>]</span>, <span>[<a href="#TPM2" class="xref">TPM2</a>]</span>) operation to feed hash values in a rolling hash function.
Each measurement added to the sequence of all measurements results in a new current digest hash value.
A TPM acts as a root of trust for reporting (RTR) by providing Quote (<span>[<a href="#TPM12" class="xref">TPM12</a>]</span>, <span>[<a href="#TPM2" class="xref">TPM2</a>]</span>) operations to generate a digest of all currently extended hash values as Evidence.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">TUDA requirements on TPM primitive operations and the information elements processed by them are illustrated using pseudocode in Appendix C and D.<a href="#section-2.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="attesting-environments-and-roots-of-trust">
<section id="section-2.4">
        <h3 id="name-attesting-environments-and-">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-attesting-environments-and-" class="section-name selfRef">Attesting Environments and Roots of Trust</a>
        </h3>
<p id="section-2.4-1">The primitive operations used to generate an initial set of measurements at the beginning of an Attester's boot sequence <span class="bcp14">MUST</span> be provided by a Root of Trust for Measurement (RTM) that is a system component of the Attester.
An RTM <span class="bcp14">MUST</span> be trusted via trust-relationships to TAs enabled by appropriate Endorsements (e.g.,EK-Certs).
If a Verifier cannot trust an RTM, measurements based on values generated by the RTM <span class="bcp14">MUST</span> be considered invalid.
At least one RTM <span class="bcp14">MUST</span> be accessible to the first Attesting Environment in Attester conducting Layered Attestation (see section 4.3. in <span>[<a href="#I-D.ietf-rats-architecture" class="xref">I-D.ietf-rats-architecture</a>]</span>).
An RTM <span class="bcp14">MAY</span> aggregate and retain measurements until the first RTS becomes available in a Layered Attestation procedure -- instead of feeding measurements into an RTS, instantly.
The Protection Capabilities of an RTM to also act as a temporary RTS <span class="bcp14">MUST</span> be trusted via trust-relationships to TAs enabled by appropriate Endorsements.
System components supporting the use of a TPM typically include such an appropriate RTM.
In general, feeding measurements from an initial RTM into a TPM is automated and separated from Protected Capabilities that provide Claims collection from Target Environments that are regular execution environments.
A TPM providing the Protection Capabilities for an isolated and shielded location to feed measurements into (integrity and confidentiality) is an appropriate RTS for TUDA.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<p id="section-2.4-2">The primitive operations used to store and chain measurements via a rolling hash function <span class="bcp14">MUST</span> be provided by an appropriate root of trust for storage (RTS) that is a system component of the Attester.
An RTS <span class="bcp14">MUST</span> be trusted via trust-relationships to TAs enabled by appropriate Endorsements (e.g.,EK-Certs).
If a Verifier cannot trust an RTS, Evidence generated based on digest values acquired from the RTS <span class="bcp14">MUST</span> be considered invalid.
An RTS <span class="bcp14">MUST</span> be accessible to all Attesting Environments that are chained in a Layered Attestation procedure.
A TPM providing the primitive operation for Extend is an appropriate RTM for TUDA.<a href="#section-2.4-2" class="pilcrow">¶</a></p>
<p id="section-2.4-3">The primitive operations used to generate Evidence based on digests <span class="bcp14">MUST</span> be provided by roots of trust for reporting (RTR) that are system components of the Attester.
An RTR <span class="bcp14">MUST</span> be be trusted via trust-relationships to TAs enabled by appropriate Endorsements (e.g.,EK-Certs).
If a Verifier cannot trust an RTR, Evidence generated by the RTR <span class="bcp14">MUST</span> be considered invalid.
A TPM providing the primitive operations for Quote is an appropriate RTR for TUDA.
In a Composite Device (see Section 3.5. in <span>[<a href="#I-D.ietf-rats-architecture" class="xref">I-D.ietf-rats-architecture</a>]</span> conducting a Layered Attestation procedure, Attesting Environments <span class="bcp14">MAY</span> not be TPMs.
At least one Attesting Environment <span class="bcp14">MUST</span> be a TPM.
At least one TPM <span class="bcp14">MUST</span> act as an RTR.
Attesting Environments that are not TPMs <span class="bcp14">MUST NOT</span> act as an RTR.<a href="#section-2.4-3" class="pilcrow">¶</a></p>
<p id="section-2.4-4">A concise definition of the terms RTM, RTS, and RTR can be found in the Trusted Computing Group (TCG) Glossary <span>[<a href="#TCGGLOSS" class="xref">TCGGLOSS</a>]</span>.
An RTS and an RTR are often tightly coupled.
In TUDA, a Trusted Platform Module (TPM, see <span>[<a href="#TPM12" class="xref">TPM12</a>]</span> and <span>[<a href="#TPM2" class="xref">TPM2</a>]</span>) takes on the roles of an RTS and an RTR.
The specification in this document requires the use of a TPM as a component of the Attester.
The protocol part of this specification can also be used with other RTS and RTR as long as essential functional requirements are satisfied (e.g., a trusted relative source of time, such as a tick-counter).
A sequence of Layered Attestation using at least an RTM, RTS, and RTR enables an authenticated boot sequence typically referred to as Secure Boot.<a href="#section-2.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="indeterministic-measurements">
<section id="section-2.5">
        <h3 id="name-indeterministic-measurement">
<a href="#section-2.5" class="section-number selfRef">2.5. </a><a href="#name-indeterministic-measurement" class="section-name selfRef">Indeterministic Measurements</a>
        </h3>
<p id="section-2.5-1">The sequence of measurements that is extended into the RTS provided by a TPM may not be deterministic due to race conditions that are side-effects of parallelization.
Parallelization occurs, for example, between different isolated execution environments or separate software components started in a execution environment.
In order to enable the appraisal of Evidence in cases where sequence of measurement varies, a corresponding event log that records all measurements in sequence, such as the IMA log, has to be conveyed next to the Evidence as depicted in section 8.2. in <span>[<a href="#I-D.ietf-rats-reference-interaction-models" class="xref">I-D.ietf-rats-reference-interaction-models</a>]</span>.<a href="#section-2.5-1" class="pilcrow">¶</a></p>
<p id="section-2.5-2">In contrast to Evidence, event logs do not necessarily have to be integrity protected or tamper-evident.
Event logs are conveyed to a Verifier in order to compute the reference values required for comparison with digest values (output of TPM Quote operations).
While digest values <span class="bcp14">MUST</span> constitute Evidence, measurements in event logs <span class="bcp14">MAY</span> be part of Evidence, but do not have to be <span class="bcp14">MAY</span> be conveyed separately.
If the values in event logs or their sequence are tampered with before or during conveyance from an Attester to a Verifier, the corresponding Evidence Appraisal fails.
While this dependency reflects the intended behavior of RATS, integrity protected or tamper-evident can be beneficial or convenient in some usage scenarios.
Additionally, event logs my allow insights into the composition of an Attester and typically come with confidentiality requirements.<a href="#section-2.5-2" class="pilcrow">¶</a></p>
<p id="section-2.5-3">In order to compute reference values to compare digest Claims in Evidence with, a Verifier <span class="bcp14">MUST</span> be able to replay the rolling hash function of the Extend operation provided by a TPM (see Section 2.4.2. in <span>[<a href="#I-D.fedorkow-rats-network-device-attestation" class="xref">I-D.fedorkow-rats-network-device-attestation</a>]</span>).<a href="#section-2.5-3" class="pilcrow">¶</a></p>
<p id="section-2.5-4">A Verifier has to replay the event log using its own extend operation with an identical rolling hash function in order to generate reference values as outlined in section 2.4.1. of <span>[<a href="#I-D.fedorkow-rats-network-device-attestation" class="xref">I-D.fedorkow-rats-network-device-attestation</a>]</span>.
During reply, the validity of each event log record <span class="bcp14">MUST</span> be appraised individually by the Verifier in order to infer if each started software component satisfies integrity requirements.
These appraisal procedures require Reference Integrity Measurements/Manifests (RIM) as are provided via <span>[<a href="#I-D.birkholz-rats-coswid-rim" class="xref">I-D.birkholz-rats-coswid-rim</a>]</span> or <span>[<a href="#TCGRIM" class="xref">TCGRIM</a>]</span>.
Each RIM includes Reference Values that are nominal reference hash values for sets of software components.
The Reference Values can be compared with hash values about executed software components included in an event log.
A Verifier requires an appropriate set of RIMs to compare every record in an event log successfully.
RIMs or other sets Reverence Value are supplied by Reference Value Providers as defined in the RATS Architecture <span>[<a href="#I-D.ietf-rats-architecture" class="xref">I-D.ietf-rats-architecture</a>]</span>.
Corresponding procedures that enable a Verifier to acquire Reference Values are out-of-scope of this document.<a href="#section-2.5-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="tuda-principles-and-requirements">
<section id="section-3">
      <h2 id="name-tuda-principles-and-require">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-tuda-principles-and-require" class="section-name selfRef">TUDA Principles and Requirements</a>
      </h2>
<p id="section-3-1">Traditional remote attestation protocols typically use bi-directional challenge/response interaction models. Examples include the Platform Trust Service protocol <span>[<a href="#PTS" class="xref">PTS</a>]</span> or CAVES <span>[<a href="#PRIRA" class="xref">PRIRA</a>]</span>, where one entity sends a challenge that is included inside the response to prove the freshness of Evidence via recentness. The corresponding interaction model depicted in Section 8.1. of <span>[<a href="#I-D.ietf-rats-reference-interaction-models" class="xref">I-D.ietf-rats-reference-interaction-models</a>]</span> tightly couples the three RATS activities of generating, conveying and appraising Evidence.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">Time-Based Uni-directional Attestation can decouple these three activities. As a result, TUDA provides additional capabilities, such as:<a href="#section-3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-3.1">remote attestation for Attesters that might not always be able to reach the Internet by enabling the appraisal of past states,<a href="#section-3-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-3.2">secure audit logs by combining the Evidence generated with integrity measurement logs (e.g. IMA logs) that represent a detailed record of corresponding past states,<a href="#section-3-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-3.3">the use of the uni-directional interaction model <span>[<a href="#I-D.ietf-rats-reference-interaction-models" class="xref">I-D.ietf-rats-reference-interaction-models</a>]</span> that can traverse "diode-like" network security functions (NSF) or can be leveraged RESTful telemetry as enabled by the CoAP Observe option <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span>).<a href="#section-3-3.3" class="pilcrow">¶</a>
</li>
      </ul>
<div id="attesting-environment-requirements">
<section id="section-3.1">
        <h3 id="name-attesting-environment-requi">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-attesting-environment-requi" class="section-name selfRef">Attesting Environment Requirements</a>
        </h3>
<p id="section-3.1-1">An Attesting Environment that generates Evidence in TUDA <span class="bcp14">MUST</span> support three specific Protected Capabilities:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.1">Platform Configuration Registers (PCR) that can extend measurements consecutively and represent the sequence of measurements as a single digest,<a href="#section-3.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-2.2">Restricted Signing Keys (RSK) that can only be accessed, if a specific signature about a set of measurements can be provided as authentication, and<a href="#section-3.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-2.3">a dedicated source of (relative) time, e.g. a tick counter (a tick being a specific time interval, for example 10 ms).<a href="#section-3.1-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.1-3">A TPM is capable of providing these Protected Capabilities for TUDA.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="handle-distributor-requirements-time-stamp-authority">
<section id="section-3.2">
        <h3 id="name-handle-distributor-requirem">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-handle-distributor-requirem" class="section-name selfRef">Handle Distributor Requirements: Time Stamp Authority</a>
        </h3>
<p id="section-3.2-1">Both Evidence generation and Evidence appraisal require a Handle Distributor that can take on the role of a trusted Time Stamp Authority (TSA) as an additional third party.
Time Stamp Tokens (TST) included in Handles <span class="bcp14">MUST</span> be generated by Time Stamp Authority based on <span>[<a href="#RFC3161" class="xref">RFC3161</a>]</span> that acts as the Handle Distributor.
The combination of a local source of time provided by a TPM (on the Attester) and the TST provided by the Handle Distributor (to both the Attester and the Verifier) enable an appropriate proof of freshness.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="information-elements-and-conveyance">
<section id="section-4">
      <h2 id="name-information-elements-and-co">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-information-elements-and-co" class="section-name selfRef">Information Elements and Conveyance</a>
      </h2>
<p id="section-4-1">TUDA defines a set of information elements (IE) that represent a set of Claims, are generated and stored on the Attester, and are intended to be transferred to the Verifier in order to enable the appraisal of Evidence. Each TUDA IE:<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">
          <span class="bcp14">MUST</span> be encoded in the Concise Binary Object Representation (CBOR <span>[<a href="#RFC8949" class="xref">RFC8949</a>]</span>) to minimize the volume of data in motion. In this document, the composition of the CBOR data items that represent IE is described using the Concise Data Definition Language, CDDL <span>[<a href="#RFC8610" class="xref">RFC8610</a>]</span>.<a href="#section-4-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.2">that requires a certain freshness <span class="bcp14">SHOULD</span> only be re-generated when out-dated (not fresh, but stale), which reduces the overall resources required from the Attester, including the usage of a TPM's resources (re-generation of IE is determined by their age or by specific state changes on the Attester, e.g., due to a reboot-cycle)<a href="#section-4-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.3">
          <span class="bcp14">SHOULD</span> only be transferred when required, which reduces the amount of data in motion necessary to conduct remote attestation significantly (only IE that have changed since their last conveyance have to be transferred)<a href="#section-4-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.4">that requires a certain freshness <span class="bcp14">SHOULD</span> be reused for multiple remote attestation procedures in the limits of its corresponding freshness-window, further reducing the load imposed on the Attester and corresponding TPMs.<a href="#section-4-2.4" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="tuda-core-concept">
<section id="section-5">
      <h2 id="name-tuda-core-concept">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-tuda-core-concept" class="section-name selfRef">TUDA Core Concept</a>
      </h2>
<p id="section-5-1">Traditional Challenge/Response Remote Attestation <span>[<a href="#I-D.ietf-rats-reference-interaction-models" class="xref">I-D.ietf-rats-reference-interaction-models</a>]</span> includes sending a nonce in the challenge to be used in ad-hoc Evidence generation. Using the TPM 1.2 as an example, a corresponding nonce-challenge would be included within the signature created by the TPM_Quote command in order to prove the freshness of a response containing evidence, see e.g. <span>[<a href="#PTS" class="xref">PTS</a>]</span>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">In contrast, the TUDA protocol uses the combined output of TPM_CertifyInfo and TPM_TickStampBlob. The former provides a proof about the Attester's state by creating Evidence that a certain key is bound to that state. The latter provides proof that the Attester was in the specified state by using the bound key in a time operation. This combination enables a time-based attestation scheme. The approach is based on the concepts introduced in <span>[<a href="#SCALE" class="xref">SCALE</a>]</span> and <span>[<a href="#SFKE2008" class="xref">SFKE2008</a>]</span>.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">Each TUDA IE has an individual time-frame, in which it is considered to be fresh (and therefore valid and trustworthy). In consequence, each TUDA IE that composes data in motion is based on different methods of creation.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">As highlighted above, the freshness properties of a challenge-response based protocol enable implicit time-keeping via a time window between:<a href="#section-5-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-5.1">the time of transmission of the nonce, and<a href="#section-5-5.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-5.2">the reception of the corresponding response.<a href="#section-5-5.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-5-6">Given the time-based attestation scheme, the freshness property of TUDA is equivalent to that of bi-directional challenge response attestation, if the point-in-time of attestation lies between:<a href="#section-5-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-7.1">the transmission of a TUDA time-synchronization token, and<a href="#section-5-7.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-7.2">the typical round-trip time between the Verifier and the Attester.<a href="#section-5-7.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-5-8">The accuracy of this time-frame is defined by two factors:<a href="#section-5-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-9.1">the time-synchronization between the Attester and the Handle Distributor. The time between the two tickstamps acquired via the RoT define the scope of the maximum drift (time "left" and time "right" in respect to the timeline) to the handle including the signed timestamp, and<a href="#section-5-9.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-9.2">the drift of clocks included in the RoT.<a href="#section-5-9.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-5-10">Since the conveyance of TUDA Evidence does not rely upon a Verifier provided value (i.e. the nonce), the security guarantees of the protocol only incorporate the Handle Distributor and the RoT used. In consequence, TUDA Evidence can even serve as proof of integrity in audit logs with precise point-in-time guarantees.<a href="#section-5-10" class="pilcrow">¶</a></p>
<p id="section-5-11"><a href="#rest" class="xref">Appendix A</a> contains guidance on how to utilize a REST architecture.<a href="#section-5-11" class="pilcrow">¶</a></p>
<p id="section-5-12"><a href="#snmp" class="xref">Appendix B</a> contains guidance on how to create an SNMP binding and a corresponding TUDA-MIB.<a href="#section-5-12" class="pilcrow">¶</a></p>
<p id="section-5-13"><a href="#yang" class="xref">Appendix C</a> contains a corresponding YANG module that supports both RESTCONF and CoREDONF.<a href="#section-5-13" class="pilcrow">¶</a></p>
<p id="section-5-14"><a href="#tpm12" class="xref">Appendix D.2</a> contains a realization of TUDA using TPM 1.2 primitives.<a href="#section-5-14" class="pilcrow">¶</a></p>
<p id="section-5-15"><a href="#tpm2" class="xref">Appendix D.3</a> contains a realization of TUDA using TPM 2.0 primitives.<a href="#section-5-15" class="pilcrow">¶</a></p>
<div id="tpm-specific-terms">
<section id="section-5.1">
        <h3 id="name-tpm-specific-terms">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-tpm-specific-terms" class="section-name selfRef">TPM Specific Terms</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-5.1-1">
          <dt id="section-5.1-1.1">PCR:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-1.2">
            <p id="section-5.1-1.2.1">A Platform Configuration Register that is part of the TPM and is used to securely store and report measurements about security posture<a href="#section-5.1-1.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-1.3">PCR-Hash:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-1.4">
            <p id="section-5.1-1.4.1">A hash value of the security posture measurements stored in a TPM PCR (e.g. regarding running software instances) represented as a byte-string<a href="#section-5.1-1.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="certificates">
<section id="section-5.2">
        <h3 id="name-certificates">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-certificates" class="section-name selfRef">Certificates</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-5.2-1">
          <dt id="section-5.2-1.1">HD-CA:</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-1.2">
            <p id="section-5.2-1.2.1">The Certificate Authority that provides the certificate for the TSA role of a Handle Distributor (HD)<a href="#section-5.2-1.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-1.3">AIK-CA:</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-1.4">
            <p id="section-5.2-1.4.1">The Certificate Authority that provides the certificate for the AK of the TPM. This is the client platform credential for this protocol. It is a placeholder for a specific CA and AK-Cert is a placeholder for the corresponding certificate, depending on what protocol was used. The specific protocols are out of scope for this document, see also <span>[<a href="#AIK-Enrollment" class="xref">AIK-Enrollment</a>]</span> and <span>[<a href="#IEEE802.1AR" class="xref">IEEE802.1AR</a>]</span>.<a href="#section-5.2-1.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="the-tuda-protocol-family">
<section id="section-6">
      <h2 id="name-the-tuda-protocol-family">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-the-tuda-protocol-family" class="section-name selfRef">The TUDA Protocol Family</a>
      </h2>
<p id="section-6-1">Time-Based Uni-Directional Attestation consists of the following seven information elements:<a href="#section-6-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-6-2">
        <dt id="section-6-2.1">Handle Distributor Certificate:</dt>
        <dd style="margin-left: 1.5em" id="section-6-2.2">
          <p id="section-6-2.2.1">The certificate of the Handle Distributor that takes on the role of TSA. The Handle Distributor certificate is used in a subsequent synchronization protocol tokens. This certificate is signed by the HD-CA.<a href="#section-6-2.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-6-2.3">AK Certificate:</dt>
        <dd style="margin-left: 1.5em" id="section-6-2.4">
          <p id="section-6-2.4.1">A certificate about the Attestation Key (AIK) used. An AK-Cert may be an <span>[<a href="#IEEE802.1AR" class="xref">IEEE802.1AR</a>]</span> IDevID or LDevID, depending on their setting of the corresponding identity property (<span>[<a href="#AIK-Credential" class="xref">AIK-Credential</a>]</span>, <span>[<a href="#AIK-Enrollment" class="xref">AIK-Enrollment</a>]</span>; see <a href="#aik" class="xref">Appendix D.2.1</a>).<a href="#section-6-2.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-6-2.5">Synchronization Token:</dt>
        <dd style="margin-left: 1.5em" id="section-6-2.6">
          <p id="section-6-2.6.1">The reference frame for Evidence is provided by the relative timestamps generated by the TPM. In order to put Evidence into relation with a Real Time Clock (RTC), it is necessary to provide a cryptographic synchronization between these trusted relative timestamps and the regular RTC that is a hardware component of the Attester. To do so, trustable timestamps are acquired from a Handle Distributor.<a href="#section-6-2.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-6-2.7">Restriction Info:</dt>
        <dd style="margin-left: 1.5em" id="section-6-2.8">
          <p id="section-6-2.8.1">Evidence Generation relies on the capability of the Rot to operate on restricted keys. Whenever the PCR values of an Attesting Environment change, a new restricted key is created that can only be operated as long as the PCRs remain in their current state.<a href="#section-6-2.8.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-6-2.9"></dt>
        <dd style="margin-left: 1.5em" id="section-6-2.10">
          <p id="section-6-2.10.1">In order to prove to the Verifier that this restricted temporary key actually has these properties and also to provide the PCR value that it is restricted, the corresponding signing capabilities of the RoT are used. The TPM creates a signed certificate using the AK about the newly created restricted key.<a href="#section-6-2.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-6-2.11">Measurement Log:</dt>
        <dd style="margin-left: 1.5em" id="section-6-2.12">
          <p id="section-6-2.12.1">A Verifier requires the means to derive the PCRs' values in order to appraise the trustworthiness of an Attester. As such, a list of those elements that were extended into the PCRs is reported. For certain environments, this step may be optional if a list of valid PCR configurations (in the form of RIM available to the Verifier) exists and no measurement log is required.<a href="#section-6-2.12.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-6-2.13">Implicit Evidence:</dt>
        <dd style="margin-left: 1.5em" id="section-6-2.14">
          <p id="section-6-2.14.1">The actual Evidence is then based on a signed timestamp provided by the RoT using the restricted temporary key that was certified in the steps above. The signed timestamp generated provides the trustable assertion that at this point in time (with respect to the relative time of the TPM
s tick counter) a certain configuration existed (namely the PCR values associated with the restricted key). In combination with the synchronization token this timestamp represented in relative time can then be related to the real-time clock.<a href="#section-6-2.14.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-6-2.15">Concise SWID tags:</dt>
        <dd style="margin-left: 1.5em" id="section-6-2.16">
          <p id="section-6-2.16.1">As an option to better assess the trustworthiness of an Attester, a Verifier can request the reference hashes (RIM, sometimes called golden measurements, known-good-values, or nominal values) of all started software components to compare them with the entries in a measurement log. References hashes regarding installed (and therefore running) software can be provided by the manufacturer via SWID tags. SWID tags are provided by the Attester using the Concise SWID representation <span>[<a href="#I-D.ietf-sacm-coswid" class="xref">I-D.ietf-sacm-coswid</a>]</span> and bundled into a collection (a RIM Manifest <span>[<a href="#I-D.birkholz-rats-coswid-rim" class="xref">I-D.birkholz-rats-coswid-rim</a>]</span>).<a href="#section-6-2.16.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-6-3">These information elements can be sent en bloc, but it is recommended
to retrieve them separately to save bandwidth, since these
elements have different update cycles. In most cases, retransmitting
all seven information elements would result in unnecessary redundancy.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">Furthermore, in some scenarios it might be feasible not to store all
elements on the Attester, but instead they could be retrieved
from another location or be pre-deployed to the Verifier.
It is also feasible to only store public keys on the Verifier and skip certificate provisioning completely in order to save bandwidth and computation time for certificate verification.<a href="#section-6-4" class="pilcrow">¶</a></p>
<div id="updatecycles">
<section id="section-6.1">
        <h3 id="name-tuda-information-elements-u">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-tuda-information-elements-u" class="section-name selfRef">TUDA Information Elements Update Cycles</a>
        </h3>
<p id="section-6.1-1">An Attester can be in various states during its uptime cycles. For TUDA, a subset of these states (which imply associated information) are important to the Evidence Generation. The specific states defined are:<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-2.1">persistent, even after a hard reboot: includes certificates
that are associated with the endpoint itself or with services it relies on.<a href="#section-6.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.1-2.2">volatile to a degree: may change at the beginning of each boot cycle.
This includes the capability of a TPM to provide relative time which provides the basis for the synchronization token and implicit attestation -- and which can reset after an Attester is powered off.<a href="#section-6.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.1-2.3">very volatile: can change during any time of an uptime cycle
(periods of time an Attester is powered on, starting with its boot sequence).
This includes the content of PCRs of a hardware RoT and thereby also the PCR-restricted signing keys used for attestation.<a href="#section-6.1-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.1-3">Depending on this "lifetime of state", data has to be transported over the wire, or not. E.g. information that does not change due to a reboot typically has to be transported only once between the Attester and the Verifier.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">There are three kinds of events that require fresh Evidence to be generated:<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-5.1">The Attester completes a boot-cycle<a href="#section-6.1-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.1-5.2">A relevant PCR changes<a href="#section-6.1-5.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.1-5.3">Too much time has passed since the Evidence Generation<a href="#section-6.1-5.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.1-6">The third event listed above is variable per application use case and also depends on the precision of the clock included in the RoT.
For usage scenarios, in which the Attester would periodically
push information to be used in an audit-log, a time-frame of approximately one update per minute should be sufficient. For those usage scenarios, where Verifiers request (pull) fresh Evidence, an implementation could potentially use a TPM continuously to always present the most freshly created Evidence. This kind of utilization can result in a bottle-neck with respect to other purposes: if unavoidable, a periodic interval of once per ten seconds is recommended, which typically leaves about 80% of available TPM resource for other applications.<a href="#section-6.1-6" class="pilcrow">¶</a></p>
<p id="section-6.1-7">The following diagram is based on the reference interaction model found in section 8.1. of <span>[<a href="#I-D.ietf-rats-reference-interaction-models" class="xref">I-D.ietf-rats-reference-interaction-models</a>]</span> and is enriched with the IE update cycles defined in this section.<a href="#section-6.1-7" class="pilcrow">¶</a></p>
<span id="name-example-sequence-of-events"></span><div id="SequenceExample">
<figure id="figure-1">
          <div id="section-6.1-8.1">
            <div class="alignLeft art-svg artwork" id="section-6.1-8.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="768" width="584" viewBox="0 0 584 768" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px">
                <path d="M 8,32 L 8,64" fill="none" stroke="black"></path>
                <path d="M 48,144 L 48,224" fill="none" stroke="black"></path>
                <path d="M 48,256 L 48,272" fill="none" stroke="black"></path>
                <path d="M 48,352 L 48,496" fill="none" stroke="black"></path>
                <path d="M 48,624 L 48,752" fill="none" stroke="black"></path>
                <path d="M 96,32 L 96,64" fill="none" stroke="black"></path>
                <path d="M 208,160 L 208,224" fill="none" stroke="black"></path>
                <path d="M 376,160 L 376,224" fill="none" stroke="black"></path>
                <path d="M 488,32 L 488,64" fill="none" stroke="black"></path>
                <path d="M 536,72 L 536,464" fill="none" stroke="black"></path>
                <path d="M 536,528 L 536,704" fill="none" stroke="black"></path>
                <path d="M 536,736 L 536,752" fill="none" stroke="black"></path>
                <path d="M 576,32 L 576,64" fill="none" stroke="black"></path>
                <path d="M 8,32 L 96,32" fill="none" stroke="black"></path>
                <path d="M 488,32 L 576,32" fill="none" stroke="black"></path>
                <path d="M 8,64 L 96,64" fill="none" stroke="black"></path>
                <path d="M 488,64 L 576,64" fill="none" stroke="black"></path>
                <path d="M 208,160 L 376,160" fill="none" stroke="black"></path>
                <path d="M 64,176 L 144,176" fill="none" stroke="black"></path>
                <path d="M 440,208 L 520,208" fill="none" stroke="black"></path>
                <path d="M 208,224 L 376,224" fill="none" stroke="black"></path>
                <path d="M 152,384 L 520,384" fill="none" stroke="black"></path>
                <path d="M 176,400 L 520,400" fill="none" stroke="black"></path>
                <path d="M 192,416 L 520,416" fill="none" stroke="black"></path>
                <path d="M 168,432 L 520,432" fill="none" stroke="black"></path>
                <path d="M 184,448 L 520,448" fill="none" stroke="black"></path>
                <path d="M 192,656 L 520,656" fill="none" stroke="black"></path>
                <path d="M 168,672 L 520,672" fill="none" stroke="black"></path>
                <path d="M 184,688 L 520,688" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="528,688 516,682.4 516,693.6" fill="black" transform="rotate(0,520,688)"></polygon>
                <polygon class="arrowhead" points="528,672 516,666.4 516,677.6" fill="black" transform="rotate(0,520,672)"></polygon>
                <polygon class="arrowhead" points="528,656 516,650.4 516,661.6" fill="black" transform="rotate(0,520,656)"></polygon>
                <polygon class="arrowhead" points="528,448 516,442.4 516,453.6" fill="black" transform="rotate(0,520,448)"></polygon>
                <polygon class="arrowhead" points="528,432 516,426.4 516,437.6" fill="black" transform="rotate(0,520,432)"></polygon>
                <polygon class="arrowhead" points="528,416 516,410.4 516,421.6" fill="black" transform="rotate(0,520,416)"></polygon>
                <polygon class="arrowhead" points="528,400 516,394.4 516,405.6" fill="black" transform="rotate(0,520,400)"></polygon>
                <polygon class="arrowhead" points="528,384 516,378.4 516,389.6" fill="black" transform="rotate(0,520,384)"></polygon>
                <polygon class="arrowhead" points="528,208 516,202.4 516,213.6" fill="black" transform="rotate(0,520,208)"></polygon>
                <polygon class="arrowhead" points="72,176 60,170.4 60,181.6" fill="black" transform="rotate(180,64,176)"></polygon>
                <g class="text">
                  <text x="52" y="52">Attester</text>
                  <text x="532" y="52">Verifier</text>
                  <text x="48" y="84">|</text>
                  <text x="44" y="100">boot</text>
                  <text x="48" y="116">|</text>
                  <text x="140" y="132">valueGeneration(targetEnvironment)</text>
                  <text x="68" y="148">=&gt;</text>
                  <text x="108" y="148">claims</text>
                  <text x="172" y="180">handle</text>
                  <text x="244" y="196">Handle</text>
                  <text x="320" y="196">Distributor</text>
                  <text x="412" y="212">handle</text>
                  <text x="80" y="244">syncTokenGeneration</text>
                  <text x="68" y="260">=&gt;</text>
                  <text x="120" y="260">syncToken</text>
                  <text x="96" y="292">restrictedKeyGeneration</text>
                  <text x="84" y="308">restrictedKeyCertify</text>
                  <text x="48" y="324">|</text>
                  <text x="108" y="340">evidenceGeneration(handle,</text>
                  <text x="264" y="340">authSecIDs,</text>
                  <text x="380" y="340">collectedClaims)</text>
                  <text x="68" y="356">=&gt;</text>
                  <text x="116" y="356">evidence</text>
                  <text x="100" y="388">pushAKCert</text>
                  <text x="112" y="404">pushSyncToken</text>
                  <text x="120" y="420">pushCertifyInfo</text>
                  <text x="108" y="436">pushEventLog</text>
                  <text x="116" y="452">pushEvidenceon</text>
                  <text x="304" y="484">evidenceAppraisal(evidence,</text>
                  <text x="456" y="484">eventLog,</text>
                  <text x="540" y="484">refClaims)</text>
                  <text x="432" y="500">attestationResult</text>
                  <text x="516" y="500">&lt;=</text>
                  <text x="536" y="500">|</text>
                  <text x="48" y="516">~</text>
                  <text x="536" y="516">~</text>
                  <text x="60" y="532">pcr-change</text>
                  <text x="48" y="548">|</text>
                  <text x="96" y="564">restrictedKeyGeneration</text>
                  <text x="84" y="580">restrictedKeyCertify</text>
                  <text x="48" y="596">|</text>
                  <text x="108" y="612">evidenceGeneration(handle,</text>
                  <text x="264" y="612">authSecIDs,</text>
                  <text x="380" y="612">collectedClaims)</text>
                  <text x="68" y="628">=&gt;</text>
                  <text x="116" y="628">evidence</text>
                  <text x="120" y="660">pushCertifyInfo</text>
                  <text x="108" y="676">pushEventLog</text>
                  <text x="116" y="692">pushEvidenceon</text>
                  <text x="304" y="724">evidenceAppraisal(evidence,</text>
                  <text x="456" y="724">eventLog,</text>
                  <text x="540" y="724">refClaims)</text>
                  <text x="432" y="740">attestationResult</text>
                  <text x="516" y="740">&lt;=</text>
                </g>
              </svg><a href="#section-6.1-8.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-example-sequence-of-events" class="selfRef">Example sequence of events</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="sync-base-protocol">
<section id="section-7">
      <h2 id="name-sync-base-protocol">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-sync-base-protocol" class="section-name selfRef">Sync Base Protocol</a>
      </h2>
<p id="section-7-1">The uni-directional approach of TUDA requires evidence on how the TPM time represented in ticks (relative time since boot of the TPM) relates to the standard time provided by the TSA.
The Sync Base Protocol (SBP) creates evidence that binds the TPM tick time to the TSA timestamp. The binding information is used by and conveyed via the Sync Token (TUDA IE). There are three actions required to create the content of a Sync Token:<a href="#section-7-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-2.1">At a given point in time (called "left"), a signed tickstamp counter value is acquired from the hardware RoT. The hash of counter and signature is used as a nonce in the request directed at the TSA.<a href="#section-7-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-2.2">The corresponding response includes a data-structure incorporating the trusted timestamp token and its signature created by the TSA.<a href="#section-7-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-2.3">At the point-in-time the response arrives (called "right"), a signed tickstamp counter value is acquired from the hardware RoT again, using a hash of the signed TSA timestamp as a nonce.<a href="#section-7-2.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-7-3">The three time-related values --- the relative timestamps provided by the hardware RoT ("left" and "right") and the TSA timestamp --- and their corresponding signatures are aggregated in order to create a corresponding Sync Token to be used as a TUDA Information Element that can be conveyed as evidence to a Verifier.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">The drift of a clock incorporated in the hardware RoT that drives the increments of the tick counter constitutes one of the triggers that can initiate a TUDA Information Element Update Cycle in respect to the freshness of the available Sync Token.<a href="#section-7-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">This memo includes requests to IANA, including registrations for media
type definitions.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">TBD<a href="#section-8-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-9">
      <h2 id="name-security-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-9-1">There are Security Considerations. TBD<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="contributors">
<section id="section-10">
      <h2 id="name-contributors">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<p id="section-10-1">TBD<a href="#section-10-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-11">
      <h2 id="name-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-11.1">
        <h3 id="name-normative-references">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3161">[RFC3161]</dt>
        <dd>
<span class="refAuthor">Adams, C.</span>, <span class="refAuthor">Cain, P.</span>, <span class="refAuthor">Pinkas, D.</span>, and <span class="refAuthor">R. Zuccherato</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Time-Stamp Protocol (TSP)"</span>, <span class="seriesInfo">RFC 3161</span>, <span class="seriesInfo">DOI 10.17487/RFC3161</span>, <time datetime="2001-08" class="refDate">August 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3161">https://www.rfc-editor.org/rfc/rfc3161</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5247">[RFC5247]</dt>
        <dd>
<span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Simon, D.</span>, and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"Extensible Authentication Protocol (EAP) Key Management Framework"</span>, <span class="seriesInfo">RFC 5247</span>, <span class="seriesInfo">DOI 10.17487/RFC5247</span>, <time datetime="2008-08" class="refDate">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5247">https://www.rfc-editor.org/rfc/rfc5247</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6690">[RFC6690]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refTitle">"Constrained RESTful Environments (CoRE) Link Format"</span>, <span class="seriesInfo">RFC 6690</span>, <span class="seriesInfo">DOI 10.17487/RFC6690</span>, <time datetime="2012-08" class="refDate">August 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6690">https://www.rfc-editor.org/rfc/rfc6690</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7252">https://www.rfc-editor.org/rfc/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8040">[RFC8040]</dt>
        <dd>
<span class="refAuthor">Bierman, A.</span>, <span class="refAuthor">Bjorklund, M.</span>, and <span class="refAuthor">K. Watsen</span>, <span class="refTitle">"RESTCONF Protocol"</span>, <span class="seriesInfo">RFC 8040</span>, <span class="seriesInfo">DOI 10.17487/RFC8040</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8040">https://www.rfc-editor.org/rfc/rfc8040</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8610">https://www.rfc-editor.org/rfc/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8820">[RFC8820]</dt>
        <dd>
<span class="refAuthor">Nottingham, M.</span>, <span class="refTitle">"URI Design and Ownership"</span>, <span class="seriesInfo">BCP 190</span>, <span class="seriesInfo">RFC 8820</span>, <span class="seriesInfo">DOI 10.17487/RFC8820</span>, <time datetime="2020-06" class="refDate">June 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8820">https://www.rfc-editor.org/rfc/rfc8820</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8949">https://www.rfc-editor.org/rfc/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9112">[RFC9112]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span>, <span class="refAuthor">Nottingham, M., Ed.</span>, and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"HTTP/1.1"</span>, <span class="seriesInfo">STD 99</span>, <span class="seriesInfo">RFC 9112</span>, <span class="seriesInfo">DOI 10.17487/RFC9112</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9112">https://www.rfc-editor.org/rfc/rfc9112</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9113">[RFC9113]</dt>
      <dd>
<span class="refAuthor">Thomson, M., Ed.</span> and <span class="refAuthor">C. Benfield, Ed.</span>, <span class="refTitle">"HTTP/2"</span>, <span class="seriesInfo">RFC 9113</span>, <span class="seriesInfo">DOI 10.17487/RFC9113</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9113">https://www.rfc-editor.org/rfc/rfc9113</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-11.2">
        <h3 id="name-informative-references">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="AIK-Credential">[AIK-Credential]</dt>
        <dd>
<span class="refAuthor">TCG Infrastructure Working Group</span>, <span class="refTitle">"TCG Credential Profile"</span>, <time datetime="2007" class="refDate">2007</time>, <span>&lt;<a href="https://www.trustedcomputinggroup.org/wp-content/uploads/IWG-Credential_Profiles_V1_R1_14.pdf">https://www.trustedcomputinggroup.org/wp-content/uploads/IWG-Credential_Profiles_V1_R1_14.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="AIK-Enrollment">[AIK-Enrollment]</dt>
        <dd>
<span class="refAuthor">TCG Infrastructure Working Group</span>, <span class="refTitle">"A CMC Profile for AIK Certificate Enrollment"</span>, <time datetime="2011" class="refDate">2011</time>, <span>&lt;<a href="https://www.trustedcomputinggroup.org/wp-content/uploads/IWG_CMC_Profile_Cert_Enrollment_v1_r7.pdf">https://www.trustedcomputinggroup.org/wp-content/uploads/IWG_CMC_Profile_Cert_Enrollment_v1_r7.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CEL">[CEL]</dt>
        <dd>
<span class="refAuthor">TCG TNC Working Group</span>, <span class="refTitle">"DRAFT Canonical Event Log Format Version: 1.0, Revision: .12"</span>, <time datetime="2018" class="refDate">2018</time>. </dd>
<dd class="break"></dd>
<dt id="I-D.birkholz-rats-coswid-rim">[I-D.birkholz-rats-coswid-rim]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Uiterwijk, P.</span>, <span class="refAuthor">Waltermire, D.</span>, <span class="refAuthor">Bhandari, S.</span>, and <span class="refAuthor">J. Fitzgerald-McKay</span>, <span class="refTitle">"Reference Integrity Measurement Extension for Concise Software Identities"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-birkholz-rats-coswid-rim-02</span>, <time datetime="2021-01-13" class="refDate">13 January 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-birkholz-rats-coswid-rim-02">https://datatracker.ietf.org/doc/html/draft-birkholz-rats-coswid-rim-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.birkholz-rats-uccs">[I-D.birkholz-rats-uccs]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">O'Donoghue, J.</span>, <span class="refAuthor">Cam-Winget, N.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"A CBOR Tag for Unprotected CWT Claims Sets"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-birkholz-rats-uccs-03</span>, <time datetime="2021-03-08" class="refDate">8 March 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-birkholz-rats-uccs-03">https://datatracker.ietf.org/doc/html/draft-birkholz-rats-uccs-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.fedorkow-rats-network-device-attestation">[I-D.fedorkow-rats-network-device-attestation]</dt>
        <dd>
<span class="refAuthor">Fedorkow, G.</span>, <span class="refAuthor">Voit, E.</span>, and <span class="refAuthor">J. Fitzgerald-McKay</span>, <span class="refTitle">"TPM-based Network Device Remote Integrity Verification"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-fedorkow-rats-network-device-attestation-05</span>, <time datetime="2020-04-16" class="refDate">16 April 2020</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-fedorkow-rats-network-device-attestation-05">https://datatracker.ietf.org/doc/html/draft-fedorkow-rats-network-device-attestation-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-comi">[I-D.ietf-core-comi]</dt>
        <dd>
<span class="refAuthor">Veillette, M.</span>, <span class="refAuthor">Stok, P. V. D.</span>, <span class="refAuthor">Pelov, A.</span>, <span class="refAuthor">Bierman, A.</span>, and <span class="refAuthor">I. Petrov</span>, <span class="refTitle">"CoAP Management Interface (CORECONF)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-comi-11</span>, <time datetime="2021-01-17" class="refDate">17 January 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-comi-11">https://datatracker.ietf.org/doc/html/draft-ietf-core-comi-11</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-architecture">[I-D.ietf-rats-architecture]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Thaler, D.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Smith, N.</span>, and <span class="refAuthor">W. Pan</span>, <span class="refTitle">"Remote Attestation Procedures Architecture"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-architecture-18</span>, <time datetime="2022-06-14" class="refDate">14 June 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-architecture-18">https://datatracker.ietf.org/doc/html/draft-ietf-rats-architecture-18</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-reference-interaction-models">[I-D.ietf-rats-reference-interaction-models]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Eckel, M.</span>, <span class="refAuthor">Pan, W.</span>, and <span class="refAuthor">E. Voit</span>, <span class="refTitle">"Reference Interaction Models for Remote Attestation Procedures"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-reference-interaction-models-05</span>, <time datetime="2022-01-26" class="refDate">26 January 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-rats-reference-interaction-models-05">https://datatracker.ietf.org/doc/html/draft-ietf-rats-reference-interaction-models-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-sacm-coswid">[I-D.ietf-sacm-coswid]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Fitzgerald-McKay, J.</span>, <span class="refAuthor">Schmidt, C.</span>, and <span class="refAuthor">D. Waltermire</span>, <span class="refTitle">"Concise Software Identification Tags"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-sacm-coswid-21</span>, <time datetime="2022-03-07" class="refDate">7 March 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-sacm-coswid-21">https://datatracker.ietf.org/doc/html/draft-ietf-sacm-coswid-21</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IEEE1609">[IEEE1609]</dt>
        <dd>
<span class="refAuthor">IEEE Computer Society</span>, <span class="refTitle">"1609.4-2016 - IEEE Standard for Wireless Access in Vehicular Environments (WAVE) -- Multi-Channel Operation"</span>, <span class="seriesInfo">IEEE Std 1609.4</span>, <time datetime="2016" class="refDate">2016</time>. </dd>
<dd class="break"></dd>
<dt id="IEEE802.1AR">[IEEE802.1AR]</dt>
        <dd>
<span class="refAuthor">IEEE Computer Society</span>, <span class="refTitle">"802.1AR-2009 - IEEE Standard for Local and metropolitan area networks - Secure Device Identity"</span>, <span class="seriesInfo">IEEE Std 802.1AR</span>, <time datetime="2009" class="refDate">2009</time>. </dd>
<dd class="break"></dd>
<dt id="PRIRA">[PRIRA]</dt>
        <dd>
<span class="refAuthor">Coker, G.</span>, <span class="refAuthor">Guttman, J.</span>, <span class="refAuthor">Loscocco, P.</span>, <span class="refAuthor">Herzog, A.</span>, <span class="refAuthor">Millen, J.</span>, <span class="refAuthor">O'Hanlon, B.</span>, <span class="refAuthor">Ramsdell, J.</span>, <span class="refAuthor">Segall, A.</span>, <span class="refAuthor">Sheehy, J.</span>, and <span class="refAuthor">B. Sniffen</span>, <span class="refTitle">"Principles of Remote Attestation"</span>, <span class="seriesInfo">Springer International Journal of Information Security, Vol. 10, pp. 63-81</span>, <span class="seriesInfo">DOI 10.1007/s10207-011-0124-7</span>, <time datetime="2011-04-23" class="refDate">23 April 2011</time>, <span>&lt;<a href="https://doi.org/10.1007/s10207-011-0124-7">https://doi.org/10.1007/s10207-011-0124-7</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PTS">[PTS]</dt>
        <dd>
<span class="refAuthor">TCG TNC Working Group</span>, <span class="refTitle">"TCG Attestation PTS Protocol Binding to TNC IF-M"</span>, <time datetime="2011" class="refDate">2011</time>, <span>&lt;<a href="https://www.trustedcomputinggroup.org/wp-content/uploads/IFM_PTS_v1_0_r28.pdf">https://www.trustedcomputinggroup.org/wp-content/uploads/IFM_PTS_v1_0_r28.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="REST">[REST]</dt>
        <dd>
<span class="refAuthor">Fielding, R.</span>, <span class="refTitle">"Architectural Styles and the Design of Network-based Software Architectures"</span>, <span class="seriesInfo">Ph.D. Dissertation, University of California, Irvine</span>, <time datetime="2000" class="refDate">2000</time>, <span>&lt;<a href="http://www.ics.uci.edu/~fielding/pubs/dissertation/fielding_dissertation.pdf">http://www.ics.uci.edu/~fielding/pubs/dissertation/fielding_dissertation.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1213">[RFC1213]</dt>
        <dd>
<span class="refAuthor">McCloghrie, K.</span> and <span class="refAuthor">M. Rose</span>, <span class="refTitle">"Management Information Base for Network Management of TCP/IP-based internets: MIB-II"</span>, <span class="seriesInfo">STD 17</span>, <span class="seriesInfo">RFC 1213</span>, <span class="seriesInfo">DOI 10.17487/RFC1213</span>, <time datetime="1991-03" class="refDate">March 1991</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc1213">https://www.rfc-editor.org/rfc/rfc1213</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2790">[RFC2790]</dt>
        <dd>
<span class="refAuthor">Waldbusser, S.</span> and <span class="refAuthor">P. Grillo</span>, <span class="refTitle">"Host Resources MIB"</span>, <span class="seriesInfo">RFC 2790</span>, <span class="seriesInfo">DOI 10.17487/RFC2790</span>, <time datetime="2000-03" class="refDate">March 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2790">https://www.rfc-editor.org/rfc/rfc2790</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4949">[RFC4949]</dt>
        <dd>
<span class="refAuthor">Shirey, R.</span>, <span class="refTitle">"Internet Security Glossary, Version 2"</span>, <span class="seriesInfo">FYI 36</span>, <span class="seriesInfo">RFC 4949</span>, <span class="seriesInfo">DOI 10.17487/RFC4949</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4949">https://www.rfc-editor.org/rfc/rfc4949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5209">[RFC5209]</dt>
        <dd>
<span class="refAuthor">Sangster, P.</span>, <span class="refAuthor">Khosravi, H.</span>, <span class="refAuthor">Mani, M.</span>, <span class="refAuthor">Narayan, K.</span>, and <span class="refAuthor">J. Tardo</span>, <span class="refTitle">"Network Endpoint Assessment (NEA): Overview and Requirements"</span>, <span class="seriesInfo">RFC 5209</span>, <span class="seriesInfo">DOI 10.17487/RFC5209</span>, <time datetime="2008-06" class="refDate">June 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5209">https://www.rfc-editor.org/rfc/rfc5209</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6933">[RFC6933]</dt>
        <dd>
<span class="refAuthor">Bierman, A.</span>, <span class="refAuthor">Romascanu, D.</span>, <span class="refAuthor">Quittek, J.</span>, and <span class="refAuthor">M. Chandramouli</span>, <span class="refTitle">"Entity MIB (Version 4)"</span>, <span class="seriesInfo">RFC 6933</span>, <span class="seriesInfo">DOI 10.17487/RFC6933</span>, <time datetime="2013-05" class="refDate">May 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6933">https://www.rfc-editor.org/rfc/rfc6933</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Safford">[Safford]</dt>
        <dd>
<span class="refAuthor">Safford, D.</span>, <span class="refAuthor">Zohar, M.</span>, and <span class="refAuthor">R. Sailer</span>, <span class="refTitle">"Using IMA for Integrity Measurement and Attestation"</span>, <span class="seriesInfo">Linux Plumbers Conference 2009 </span>, <time datetime="2009" class="refDate">2009</time>. </dd>
<dd class="break"></dd>
<dt id="SCALE">[SCALE]</dt>
        <dd>
<span class="refAuthor">Fuchs, A.</span>, <span class="refTitle">"Improving Scalability for Remote Attestation"</span>, <span class="seriesInfo">Master Thesis (Diplomarbeit), Technische Universitaet Darmstadt, Germany</span>, <time datetime="2008" class="refDate">2008</time>. </dd>
<dd class="break"></dd>
<dt id="SFKE2008">[SFKE2008]</dt>
        <dd>
<span class="refAuthor">Stumpf, F.</span>, <span class="refAuthor">Fuchs, A.</span>, <span class="refAuthor">Katzenbeisser, S.</span>, and <span class="refAuthor">C. Eckert</span>, <span class="refTitle">"Improving the scalability of platform attestation"</span>, <span class="seriesInfo">ACM Proceedings of the 3rd ACM workshop on Scalable trusted computing - STC '08</span>, <span class="seriesInfo">page 1-10</span>, <span class="seriesInfo">DOI 10.1145/1456455.1456457</span>, <time datetime="2008" class="refDate">2008</time>, <span>&lt;<a href="https://doi.org/10.1145/1456455.1456457">https://doi.org/10.1145/1456455.1456457</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="STD62">[STD62]</dt>
        <dd><div class="refInstance" id="RFC3411">
            <span class="refAuthor">Harrington, D.</span>, <span class="refAuthor">Presuhn, R.</span>, and <span class="refAuthor">B. Wijnen</span>, <span class="refTitle">"An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks"</span>, <span class="seriesInfo">STD 62</span>, <span class="seriesInfo">RFC 3411</span>, <time datetime="2002-12" class="refDate">December 2002</time>. </div>
<div class="refInstance" id="RFC3412">
            <span class="refAuthor">Case, J.</span>, <span class="refAuthor">Harrington, D.</span>, <span class="refAuthor">Presuhn, R.</span>, and <span class="refAuthor">B. Wijnen</span>, <span class="refTitle">"Message Processing and Dispatching for the Simple Network Management Protocol (SNMP)"</span>, <span class="seriesInfo">STD 62</span>, <span class="seriesInfo">RFC 3412</span>, <time datetime="2002-12" class="refDate">December 2002</time>. </div>
<div class="refInstance" id="RFC3413">
            <span class="refAuthor">Levi, D.</span>, <span class="refAuthor">Meyer, P.</span>, and <span class="refAuthor">B. Stewart</span>, <span class="refTitle">"Simple Network Management Protocol (SNMP) Applications"</span>, <span class="seriesInfo">STD 62</span>, <span class="seriesInfo">RFC 3413</span>, <time datetime="2002-12" class="refDate">December 2002</time>. </div>
<div class="refInstance" id="RFC3414">
            <span class="refAuthor">Blumenthal, U.</span> and <span class="refAuthor">B. Wijnen</span>, <span class="refTitle">"User-based Security Model (USM) for version 3 of the Simple Network Management Protocol (SNMPv3)"</span>, <span class="seriesInfo">STD 62</span>, <span class="seriesInfo">RFC 3414</span>, <time datetime="2002-12" class="refDate">December 2002</time>. </div>
<div class="refInstance" id="RFC3415">
            <span class="refAuthor">Wijnen, B.</span>, <span class="refAuthor">Presuhn, R.</span>, and <span class="refAuthor">K. McCloghrie</span>, <span class="refTitle">"View-based Access Control Model (VACM) for the Simple Network Management Protocol (SNMP)"</span>, <span class="seriesInfo">STD 62</span>, <span class="seriesInfo">RFC 3415</span>, <time datetime="2002-12" class="refDate">December 2002</time>. </div>
<div class="refInstance" id="RFC3416">
            <span class="refAuthor">Presuhn, R., Ed.</span>, <span class="refTitle">"Version 2 of the Protocol Operations for the Simple Network Management Protocol (SNMP)"</span>, <span class="seriesInfo">STD 62</span>, <span class="seriesInfo">RFC 3416</span>, <time datetime="2002-12" class="refDate">December 2002</time>. </div>
<div class="refInstance" id="RFC3417">
            <span class="refAuthor">Presuhn, R., Ed.</span>, <span class="refTitle">"Transport Mappings for the Simple Network Management Protocol (SNMP)"</span>, <span class="seriesInfo">STD 62</span>, <span class="seriesInfo">RFC 3417</span>, <time datetime="2002-12" class="refDate">December 2002</time>. </div>
<div class="refInstance" id="RFC3418">
            <span class="refAuthor">Presuhn, R., Ed.</span>, <span class="refTitle">"Management Information Base (MIB) for the Simple Network Management Protocol (SNMP)"</span>, <span class="seriesInfo">STD 62</span>, <span class="seriesInfo">RFC 3418</span>, <time datetime="2002-12" class="refDate">December 2002</time>. </div>
<span>&lt;<a href="https://www.rfc-editor.org/info/std62">https://www.rfc-editor.org/info/std62</a>&gt;</span>
</dd>
<dd class="break"></dd>
<dt id="Steffens">[Steffens]</dt>
        <dd>
<span class="refAuthor">Steffen, A.</span>, <span class="refTitle">"The linux Integrity Measurement Architecture and TPM-based Network Endpoint Assessment"</span>, <span class="seriesInfo">Linux Security Summit </span>, <time datetime="2012" class="refDate">2012</time>. </dd>
<dd class="break"></dd>
<dt id="TCGGLOSS">[TCGGLOSS]</dt>
        <dd>
<span class="refAuthor">TCG</span>, <span class="refTitle">"TCG Glossary"</span>, <time datetime="2012" class="refDate">2012</time>, <span>&lt;<a href="https://www.trustedcomputinggroup.org/wp-content/uploads/TCG_Glossary_Board-Approved_12.13.2012.pdf">https://www.trustedcomputinggroup.org/wp-content/uploads/TCG_Glossary_Board-Approved_12.13.2012.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TCGRIM">[TCGRIM]</dt>
        <dd>
<span class="refAuthor">TCG</span>, <span class="refTitle">"TCG Reference Integrity Manifest (RIM) Information Model"</span>, <time datetime="2019" class="refDate">2019</time>, <span>&lt;<a href="https://trustedcomputinggroup.org/wp-content/uploads/TCG_RIM_Model_v1-r13_2feb20.pdf">https://trustedcomputinggroup.org/wp-content/uploads/TCG_RIM_Model_v1-r13_2feb20.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TPM12">[TPM12]</dt>
        <dd>
<span class="refTitle">"Information technology -- Trusted Platform Module -- Part 1: Overview"</span>, <span class="seriesInfo">ISO/IEC 11889-1</span>, <time datetime="2009" class="refDate">2009</time>. </dd>
<dd class="break"></dd>
<dt id="TPM2">[TPM2]</dt>
      <dd>
<span class="refAuthor">Trusted Computing Group</span>, <span class="refTitle">"Trusted Platform Module Library Specification, Family 2.0, Level 00, Revision 01.16 ed."</span>, <time datetime="2014" class="refDate">2014</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="rest">
<section id="appendix-A">
      <h2 id="name-rest-realization">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-rest-realization" class="section-name selfRef">REST Realization</a>
      </h2>
<p id="appendix-A-1">Each of the seven data items is defined as a media type (<a href="#iana" class="xref">Section 8</a>).
Representations of resources for each of these media types can be
retrieved from URIs that are defined by the respective servers <span>[<a href="#RFC8820" class="xref">RFC8820</a>]</span>.
As can be derived from the URI, the actual retrieval is via one of the HTTPs
(<span>[<a href="#RFC9112" class="xref">RFC9112</a>]</span>, <span>[<a href="#RFC9113" class="xref">RFC9113</a>]</span>) or CoAP <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span>.  How a client obtains
these URIs is dependent on the application; e.g., CoRE Web links <span>[<a href="#RFC6690" class="xref">RFC6690</a>]</span>
can be used to obtain the relevant URIs from the self-description of a
server, or they could be prescribed by a RESTCONF data model <span>[<a href="#RFC8040" class="xref">RFC8040</a>]</span>.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="snmp">
<section id="appendix-B">
      <h2 id="name-snmp-realization">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-snmp-realization" class="section-name selfRef">SNMP Realization</a>
      </h2>
<p id="appendix-B-1">SNMPv3 (RFC 3411, <span>[<a href="#STD62" class="xref">STD62</a>]</span>) is widely available on computers and also constrained devices.
To transport the TUDA information elements, an SNMP MIB is defined below which
encodes each of the seven TUDA information elements into a table.  Each row in a
table contains a single read-only columnar SNMP object of datatype OCTET-STRING.
The values of a set of rows in each table can be concatenated to reconstitute a
CBOR-encoded TUDA information element.  The Verifier can retrieve the values for
each CBOR fragment by using SNMP GetNext requests to "walk" each table and can
decode each of the CBOR-encoded data items based on the corresponding CDDL <span>[<a href="#RFC8610" class="xref">RFC8610</a>]</span>
definition.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">Design Principles:<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-B-3">
<li id="appendix-B-3.1">Over time, TUDA attestation values age and should no longer be used.  Every
table in the TUDA MIB has a primary index with the value of a separate
scalar cycle counter object that disambiguates the transition from one
attestation cycle to the next.<a href="#appendix-B-3.1" class="pilcrow">¶</a>
</li>
        <li id="appendix-B-3.2">Over time, the measurement log information (for example) may grow
large. Therefore, read-only cycle counter scalar objects in all TUDA MIB object
groups facilitate more efficient access with SNMP GetNext requests.<a href="#appendix-B-3.2" class="pilcrow">¶</a>
</li>
        <li id="appendix-B-3.3">Notifications are supported by an SNMP trap definition with all of the cycle
counters as bindings, to alert a Verifier that a new attestation cycle has
occurred (e.g., synchronization data, measurement log, etc. have been updated
by adding new rows and possibly deleting old rows).<a href="#appendix-B-3.3" class="pilcrow">¶</a>
</li>
      </ol>
<div id="structure-of-tuda-mib">
<section id="appendix-B.1">
        <h3 id="name-structure-of-tuda-mib">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-structure-of-tuda-mib" class="section-name selfRef">Structure of TUDA MIB</a>
        </h3>
<p id="appendix-B.1-1">The following table summarizes the object groups, tables and their indexes, and conformance requirements for the TUDA MIB:<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Group/Table</th>
              <th class="text-left" rowspan="1" colspan="1">Cycle</th>
              <th class="text-left" rowspan="1" colspan="1">Instance</th>
              <th class="text-left" rowspan="1" colspan="1">Fragment</th>
              <th class="text-left" rowspan="1" colspan="1">Required</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">General</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">x</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">AIKCert</td>
              <td class="text-left" rowspan="1" colspan="1">x</td>
              <td class="text-left" rowspan="1" colspan="1">x</td>
              <td class="text-left" rowspan="1" colspan="1">x</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TSACert</td>
              <td class="text-left" rowspan="1" colspan="1">x</td>
              <td class="text-left" rowspan="1" colspan="1">x</td>
              <td class="text-left" rowspan="1" colspan="1">x</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">SyncToken</td>
              <td class="text-left" rowspan="1" colspan="1">x</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">x</td>
              <td class="text-left" rowspan="1" colspan="1">x</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Restrict</td>
              <td class="text-left" rowspan="1" colspan="1">x</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">x</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Measure</td>
              <td class="text-left" rowspan="1" colspan="1">x</td>
              <td class="text-left" rowspan="1" colspan="1">x</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">VerifyToken</td>
              <td class="text-left" rowspan="1" colspan="1">x</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">x</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">SWIDTag</td>
              <td class="text-left" rowspan="1" colspan="1">x</td>
              <td class="text-left" rowspan="1" colspan="1">x</td>
              <td class="text-left" rowspan="1" colspan="1">x</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
          </tbody>
        </table>
<div id="cycle-index">
<section id="appendix-B.1.1">
          <h4 id="name-cycle-index">
<a href="#appendix-B.1.1" class="section-number selfRef">B.1.1. </a><a href="#name-cycle-index" class="section-name selfRef">Cycle Index</a>
          </h4>
<p id="appendix-B.1.1-1">A tudaV1&lt;Group&gt;CycleIndex is the:<a href="#appendix-B.1.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-B.1.1-2">
<li id="appendix-B.1.1-2.1">first index of a row (element instance or element fragment) in the
tudaV1&lt;Group&gt;Table;<a href="#appendix-B.1.1-2.1" class="pilcrow">¶</a>
</li>
            <li id="appendix-B.1.1-2.2">identifier of an update cycle on the table, when rows were added and/or
deleted from the table (bounded by tudaV1&lt;Group&gt;Cycles); and<a href="#appendix-B.1.1-2.2" class="pilcrow">¶</a>
</li>
            <li id="appendix-B.1.1-2.3">binding in the tudaV1TrapV2Cycles notification for directed polling.<a href="#appendix-B.1.1-2.3" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
<div id="instance-index">
<section id="appendix-B.1.2">
          <h4 id="name-instance-index">
<a href="#appendix-B.1.2" class="section-number selfRef">B.1.2. </a><a href="#name-instance-index" class="section-name selfRef">Instance Index</a>
          </h4>
<p id="appendix-B.1.2-1">A tudaV1&lt;Group&gt;InstanceIndex is the:<a href="#appendix-B.1.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-B.1.2-2">
<li id="appendix-B.1.2-2.1">second index of a row (element instance or element fragment) in the
tudaV1&lt;Group&gt;Table; except for<a href="#appendix-B.1.2-2.1" class="pilcrow">¶</a>
</li>
            <li id="appendix-B.1.2-2.2">a row in the tudaV1SyncTokenTable (that has only one instance per cycle).<a href="#appendix-B.1.2-2.2" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
<div id="fragment-index">
<section id="appendix-B.1.3">
          <h4 id="name-fragment-index">
<a href="#appendix-B.1.3" class="section-number selfRef">B.1.3. </a><a href="#name-fragment-index" class="section-name selfRef">Fragment Index</a>
          </h4>
<p id="appendix-B.1.3-1">A tudaV1&lt;Group&gt;FragmentIndex is the:<a href="#appendix-B.1.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-B.1.3-2">
<li id="appendix-B.1.3-2.1">last index of a row (always an element fragment) in the
tudaV1&lt;Group&gt;Table; and<a href="#appendix-B.1.3-2.1" class="pilcrow">¶</a>
</li>
            <li id="appendix-B.1.3-2.2">accomodation for SNMP transport mapping restrictions for large string
elements that require fragmentation.<a href="#appendix-B.1.3-2.2" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
</section>
</div>
<div id="relationship-to-host-resources-mib">
<section id="appendix-B.2">
        <h3 id="name-relationship-to-host-resour">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-relationship-to-host-resour" class="section-name selfRef">Relationship to Host Resources MIB</a>
        </h3>
<p id="appendix-B.2-1">The General group in the TUDA MIB is analogous to the System group in the
Host Resources MIB <span>[<a href="#RFC2790" class="xref">RFC2790</a>]</span> and provides context information for the TUDA
attestation process.<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
<p id="appendix-B.2-2">The Verify Token group in the TUDA MIB is analogous to the Device group in
the Host MIB and represents the verifiable state of a TPM device and its
associated system.<a href="#appendix-B.2-2" class="pilcrow">¶</a></p>
<p id="appendix-B.2-3">The SWID Tag group (containing a Concise SWID reference hash profile <span>[<a href="#I-D.ietf-sacm-coswid" class="xref">I-D.ietf-sacm-coswid</a>]</span>) in the TUDA MIB is analogous to the Software Installed and
Software Running groups in the Host Resources MIB <span>[<a href="#RFC2790" class="xref">RFC2790</a>]</span>.<a href="#appendix-B.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="relationship-to-entity-mib">
<section id="appendix-B.3">
        <h3 id="name-relationship-to-entity-mib">
<a href="#appendix-B.3" class="section-number selfRef">B.3. </a><a href="#name-relationship-to-entity-mib" class="section-name selfRef">Relationship to Entity MIB</a>
        </h3>
<p id="appendix-B.3-1">The General group in the TUDA MIB is analogous to the Entity General group in
the Entity MIB v4 <span>[<a href="#RFC6933" class="xref">RFC6933</a>]</span> and provides context information for the TUDA
attestation process.<a href="#appendix-B.3-1" class="pilcrow">¶</a></p>
<p id="appendix-B.3-2">The SWID Tag group in the TUDA MIB is analogous to the Entity Logical group
in the Entity MIB v4 <span>[<a href="#RFC6933" class="xref">RFC6933</a>]</span>.<a href="#appendix-B.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="relationship-to-other-mibs">
<section id="appendix-B.4">
        <h3 id="name-relationship-to-other-mibs">
<a href="#appendix-B.4" class="section-number selfRef">B.4. </a><a href="#name-relationship-to-other-mibs" class="section-name selfRef">Relationship to Other MIBs</a>
        </h3>
<p id="appendix-B.4-1">The General group in the TUDA MIB is analogous to the System group in MIB-II
<span>[<a href="#RFC1213" class="xref">RFC1213</a>]</span> and the System group in the SNMPv2 MIB (RFC 3418, <span>[<a href="#STD62" class="xref">STD62</a>]</span>) and provides
context information for the TUDA attestation process.<a href="#appendix-B.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="definition-of-tuda-mib">
<section id="appendix-B.5">
        <h3 id="name-definition-of-tuda-mib">
<a href="#appendix-B.5" class="section-number selfRef">B.5. </a><a href="#name-definition-of-tuda-mib" class="section-name selfRef">Definition of TUDA MIB</a>
        </h3>
<div id="appendix-B.5-1">
<pre class="breakable lang-mib sourcecode">&lt;CODE BEGINS&gt;
TUDA-V1-ATTESTATION-MIB DEFINITIONS ::= BEGIN

IMPORTS
    MODULE-IDENTITY, OBJECT-TYPE, Integer32, Counter32,
    enterprises, NOTIFICATION-TYPE
        FROM SNMPv2-SMI                 -- RFC 2578
    MODULE-COMPLIANCE, OBJECT-GROUP, NOTIFICATION-GROUP
        FROM SNMPv2-CONF                -- RFC 2580
    SnmpAdminString
        FROM SNMP-FRAMEWORK-MIB;        -- RFC 3411

tudaV1MIB MODULE-IDENTITY
    LAST-UPDATED    "202101130000Z" --  13 January 2021
    ORGANIZATION
        "Fraunhofer SIT"
    CONTACT-INFO
        "Andreas Fuchs
        Fraunhofer Institute for Secure Information Technology
        Email: andreas.fuchs@sit.fraunhofer.de

        Henk Birkholz
        Fraunhofer Institute for Secure Information Technology
        Email: henk.birkholz@sit.fraunhofer.de

        Ira E McDonald
        High North Inc
        Email: blueroofmusic@gmail.com

        Carsten Bormann
        Universitaet Bremen TZI
        Email: cabo@tzi.org"

    DESCRIPTION
        "The MIB module for monitoring of time-based unidirectional
        attestation information from a network endpoint system,
        based on the Trusted Computing Group TPM 1.2 definition.

        Copyright (C) High North Inc (2021)."

    REVISION "202101130000Z" -- 13 January 2021
    DESCRIPTION
        "Twelfth version, published as draft-birkholz-rats-tuda-04."

    REVISION "202007130000Z" -- 13 July 2020
    DESCRIPTION
        "Eleventh version, published as draft-birkholz-rats-tuda-03."

    REVISION "202003090000Z" -- 09 March 2020
    DESCRIPTION
        "Tenth version, published as draft-birkholz-rats-tuda-02."

    REVISION "201909110000Z" -- 11 September 2019
    DESCRIPTION
        "Ninth version, published as draft-birkholz-rats-tuda-01."

    REVISION "201903120000Z" -- 12 March 2019
    DESCRIPTION
        "Eighth version, published as draft-birkholz-rats-tuda-00."

    REVISION "201805030000Z" -- 03 May 2018
    DESCRIPTION
        "Seventh version, published as draft-birkholz-i2nsf-tuda-03."

    REVISION "201805020000Z" -- 02 May 2018
    DESCRIPTION
        "Sixth version, published as draft-birkholz-i2nsf-tuda-02."

    REVISION "201710300000Z" -- 30 October 2017
    DESCRIPTION
        "Fifth version, published as draft-birkholz-i2nsf-tuda-01."

    REVISION "201701090000Z" -- 09 January 2017
    DESCRIPTION
        "Fourth version, published as draft-birkholz-i2nsf-tuda-00."

    REVISION "201607080000Z" -- 08 July 2016
    DESCRIPTION
        "Third version, published as draft-birkholz-tuda-02."

    REVISION "201603210000Z" -- 21 March 2016
    DESCRIPTION
        "Second version, published as draft-birkholz-tuda-01."

    REVISION "201510180000Z" -- 18 October 2015
    DESCRIPTION
        "Initial version, published as draft-birkholz-tuda-00."

        ::= { enterprises fraunhofersit(21616) mibs(1) tudaV1MIB(1) }

tudaV1MIBNotifications      OBJECT IDENTIFIER ::= { tudaV1MIB 0 }
tudaV1MIBObjects            OBJECT IDENTIFIER ::= { tudaV1MIB 1 }
tudaV1MIBConformance        OBJECT IDENTIFIER ::= { tudaV1MIB 2 }

--
--  General
--
tudaV1General           OBJECT IDENTIFIER ::= { tudaV1MIBObjects 1 }

tudaV1GeneralCycles OBJECT-TYPE
    SYNTAX      Counter32
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "Count of TUDA update cycles that have occurred, i.e.,
        sum of all the individual group cycle counters.

        DEFVAL intentionally omitted - counter object."
    ::= { tudaV1General 1 }

tudaV1GeneralVersionInfo OBJECT-TYPE
    SYNTAX      SnmpAdminString (SIZE(0..255))
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "Version information for TUDA MIB, e.g., specific release
        version of TPM 1.2 base specification and release version
        of TPM 1.2 errata specification and manufacturer and model
        TPM module itself."
    DEFVAL      { "" }
    ::= { tudaV1General 2 }

--
--  AIK Cert
--
tudaV1AIKCert           OBJECT IDENTIFIER ::= { tudaV1MIBObjects 2 }

tudaV1AIKCertCycles OBJECT-TYPE
    SYNTAX      Counter32
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "Count of AIK Certificate chain update cycles that have
        occurred.

        DEFVAL intentionally omitted - counter object."
    ::= { tudaV1AIKCert 1 }

tudaV1AIKCertTable OBJECT-TYPE
    SYNTAX      SEQUENCE OF TudaV1AIKCertEntry
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "A table of fragments of AIK Certificate data."
    ::= { tudaV1AIKCert 2 }

tudaV1AIKCertEntry OBJECT-TYPE
    SYNTAX      TudaV1AIKCertEntry
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "An entry for one fragment of AIK Certificate data."
    INDEX       { tudaV1AIKCertCycleIndex,
                  tudaV1AIKCertInstanceIndex,
                  tudaV1AIKCertFragmentIndex }
    ::= { tudaV1AIKCertTable 1 }

TudaV1AIKCertEntry ::=
    SEQUENCE {
        tudaV1AIKCertCycleIndex         Integer32,
        tudaV1AIKCertInstanceIndex      Integer32,
        tudaV1AIKCertFragmentIndex      Integer32,
        tudaV1AIKCertData               OCTET STRING
    }

tudaV1AIKCertCycleIndex OBJECT-TYPE
    SYNTAX      Integer32 (1..2147483647)
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "High-order index of this AIK Certificate fragment.
        Index of an AIK Certificate chain update cycle that has
        occurred (bounded by the value of tudaV1AIKCertCycles).

        DEFVAL intentionally omitted - index object."
    ::= { tudaV1AIKCertEntry 1 }

tudaV1AIKCertInstanceIndex OBJECT-TYPE
    SYNTAX      Integer32 (1..2147483647)
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "Middle index of this AIK Certificate fragment.
        Ordinal of this AIK Certificate in this chain, where the AIK
        Certificate itself has an ordinal of '1' and higher ordinals
        go *up* the certificate chain to the Root CA.

        DEFVAL intentionally omitted - index object."
    ::= { tudaV1AIKCertEntry 2 }

tudaV1AIKCertFragmentIndex OBJECT-TYPE
    SYNTAX      Integer32 (1..2147483647)
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "Low-order index of this AIK Certificate fragment.

        DEFVAL intentionally omitted - index object."
    ::= { tudaV1AIKCertEntry 3 }

tudaV1AIKCertData OBJECT-TYPE
    SYNTAX      OCTET STRING (SIZE(0..1024))
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "A fragment of CBOR encoded AIK Certificate data."
    DEFVAL      { "" }
    ::= { tudaV1AIKCertEntry 4 }

--
--  TSA Cert
--
tudaV1TSACert           OBJECT IDENTIFIER ::= { tudaV1MIBObjects 3 }

tudaV1TSACertCycles OBJECT-TYPE
    SYNTAX      Counter32
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "Count of TSA Certificate chain update cycles that have
        occurred.

        DEFVAL intentionally omitted - counter object."
    ::= { tudaV1TSACert 1 }

tudaV1TSACertTable OBJECT-TYPE
    SYNTAX      SEQUENCE OF TudaV1TSACertEntry
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "A table of fragments of TSA Certificate data."
    ::= { tudaV1TSACert 2 }

tudaV1TSACertEntry OBJECT-TYPE
    SYNTAX      TudaV1TSACertEntry
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "An entry for one fragment of TSA Certificate data."
    INDEX       { tudaV1TSACertCycleIndex,
                  tudaV1TSACertInstanceIndex,
                  tudaV1TSACertFragmentIndex }
    ::= { tudaV1TSACertTable 1 }

TudaV1TSACertEntry ::=
    SEQUENCE {
        tudaV1TSACertCycleIndex         Integer32,
        tudaV1TSACertInstanceIndex      Integer32,
        tudaV1TSACertFragmentIndex      Integer32,
        tudaV1TSACertData               OCTET STRING
    }

tudaV1TSACertCycleIndex OBJECT-TYPE
    SYNTAX      Integer32 (1..2147483647)
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "High-order index of this TSA Certificate fragment.
        Index of a TSA Certificate chain update cycle that has
        occurred (bounded by the value of tudaV1TSACertCycles).

        DEFVAL intentionally omitted - index object."
    ::= { tudaV1TSACertEntry 1 }

tudaV1TSACertInstanceIndex OBJECT-TYPE
    SYNTAX      Integer32 (1..2147483647)
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "Middle index of this TSA Certificate fragment.
        Ordinal of this TSA Certificate in this chain, where the TSA
        Certificate itself has an ordinal of '1' and higher ordinals
        go *up* the certificate chain to the Root CA.

        DEFVAL intentionally omitted - index object."
    ::= { tudaV1TSACertEntry 2 }

tudaV1TSACertFragmentIndex OBJECT-TYPE
    SYNTAX      Integer32 (1..2147483647)
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "Low-order index of this TSA Certificate fragment.

        DEFVAL intentionally omitted - index object."
    ::= { tudaV1TSACertEntry 3 }

tudaV1TSACertData OBJECT-TYPE
    SYNTAX      OCTET STRING (SIZE(0..1024))
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "A fragment of CBOR encoded TSA Certificate data."
    DEFVAL      { "" }
    ::= { tudaV1TSACertEntry 4 }

--
--  Sync Token
--
tudaV1SyncToken         OBJECT IDENTIFIER ::= { tudaV1MIBObjects 4 }

tudaV1SyncTokenCycles OBJECT-TYPE
    SYNTAX      Counter32
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "Count of Sync Token update cycles that have
        occurred.

        DEFVAL intentionally omitted - counter object."
    ::= { tudaV1SyncToken 1 }

tudaV1SyncTokenInstances OBJECT-TYPE
    SYNTAX      Counter32
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "Count of Sync Token instance entries that have
        been recorded (some entries MAY have been pruned).

        DEFVAL intentionally omitted - counter object."
    ::= { tudaV1SyncToken 2 }

tudaV1SyncTokenTable OBJECT-TYPE
    SYNTAX      SEQUENCE OF TudaV1SyncTokenEntry
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "A table of fragments of Sync Token data."
    ::= { tudaV1SyncToken 3 }

tudaV1SyncTokenEntry OBJECT-TYPE
    SYNTAX      TudaV1SyncTokenEntry
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "An entry for one fragment of Sync Token data."
    INDEX       { tudaV1SyncTokenCycleIndex,
                  tudaV1SyncTokenInstanceIndex,
                  tudaV1SyncTokenFragmentIndex }
    ::= { tudaV1SyncTokenTable 1 }

TudaV1SyncTokenEntry ::=
    SEQUENCE {
        tudaV1SyncTokenCycleIndex       Integer32,
        tudaV1SyncTokenInstanceIndex    Integer32,
        tudaV1SyncTokenFragmentIndex    Integer32,
        tudaV1SyncTokenData             OCTET STRING
    }

tudaV1SyncTokenCycleIndex OBJECT-TYPE
    SYNTAX      Integer32 (1..2147483647)
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "High-order index of this Sync Token fragment.
        Index of a Sync Token update cycle that has
        occurred (bounded by the value of tudaV1SyncTokenCycles).

        DEFVAL intentionally omitted - index object."
    ::= { tudaV1SyncTokenEntry 1 }

tudaV1SyncTokenInstanceIndex OBJECT-TYPE
    SYNTAX      Integer32 (1..2147483647)
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "Middle index of this Sync Token fragment.
        Ordinal of this instance of Sync Token data
        (NOT bounded by the value of tudaV1SyncTokenInstances).

        DEFVAL intentionally omitted - index object."
    ::= { tudaV1SyncTokenEntry 2 }

tudaV1SyncTokenFragmentIndex OBJECT-TYPE
    SYNTAX      Integer32 (1..2147483647)
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "Low-order index of this Sync Token fragment.

        DEFVAL intentionally omitted - index object."
    ::= { tudaV1SyncTokenEntry 3 }

tudaV1SyncTokenData OBJECT-TYPE
    SYNTAX      OCTET STRING (SIZE(0..1024))
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "A fragment of CBOR encoded Sync Token data."
    DEFVAL      { "" }
    ::= { tudaV1SyncTokenEntry 4 }

--
--  Restriction Info
--
tudaV1Restrict          OBJECT IDENTIFIER ::= { tudaV1MIBObjects 5 }

tudaV1RestrictCycles OBJECT-TYPE
    SYNTAX      Counter32
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "Count of Restriction Info update cycles that have
        occurred.

        DEFVAL intentionally omitted - counter object."
    ::= { tudaV1Restrict 1 }

tudaV1RestrictTable OBJECT-TYPE
    SYNTAX      SEQUENCE OF TudaV1RestrictEntry
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "A table of instances of Restriction Info data."
    ::= { tudaV1Restrict 2 }

tudaV1RestrictEntry OBJECT-TYPE
    SYNTAX      TudaV1RestrictEntry
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "An entry for one instance of Restriction Info data."
    INDEX       { tudaV1RestrictCycleIndex }
    ::= { tudaV1RestrictTable 1 }

TudaV1RestrictEntry ::=
    SEQUENCE {
        tudaV1RestrictCycleIndex        Integer32,
        tudaV1RestrictData              OCTET STRING
    }

tudaV1RestrictCycleIndex OBJECT-TYPE
    SYNTAX      Integer32 (1..2147483647)
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "Index of this Restriction Info entry.
        Index of a Restriction Info update cycle that has
        occurred (bounded by the value of tudaV1RestrictCycles).

        DEFVAL intentionally omitted - index object."
    ::= { tudaV1RestrictEntry 1 }


tudaV1RestrictData OBJECT-TYPE
    SYNTAX      OCTET STRING (SIZE(0..1024))
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "An instance of CBOR encoded Restriction Info data."
    DEFVAL      { "" }
    ::= { tudaV1RestrictEntry 2 }

--
--  Measurement Log
--
tudaV1Measure           OBJECT IDENTIFIER ::= { tudaV1MIBObjects 6 }

tudaV1MeasureCycles OBJECT-TYPE
    SYNTAX      Counter32
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "Count of Measurement Log update cycles that have
        occurred.

        DEFVAL intentionally omitted - counter object."
    ::= { tudaV1Measure 1 }

tudaV1MeasureInstances OBJECT-TYPE
    SYNTAX      Counter32
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "Count of Measurement Log instance entries that have
        been recorded (some entries MAY have been pruned).

        DEFVAL intentionally omitted - counter object."
    ::= { tudaV1Measure 2 }

tudaV1MeasureTable OBJECT-TYPE
    SYNTAX      SEQUENCE OF TudaV1MeasureEntry
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "A table of instances of Measurement Log data."
    ::= { tudaV1Measure 3 }

tudaV1MeasureEntry OBJECT-TYPE
    SYNTAX      TudaV1MeasureEntry
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "An entry for one instance of Measurement Log data."
    INDEX       { tudaV1MeasureCycleIndex,
                  tudaV1MeasureInstanceIndex }
    ::= { tudaV1MeasureTable 1 }

TudaV1MeasureEntry ::=
    SEQUENCE {
        tudaV1MeasureCycleIndex         Integer32,
        tudaV1MeasureInstanceIndex      Integer32,
        tudaV1MeasureData               OCTET STRING
    }

tudaV1MeasureCycleIndex OBJECT-TYPE
    SYNTAX      Integer32 (1..2147483647)
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "High-order index of this Measurement Log entry.
        Index of a Measurement Log update cycle that has
        occurred (bounded by the value of tudaV1MeasureCycles).

        DEFVAL intentionally omitted - index object."
    ::= { tudaV1MeasureEntry 1 }

tudaV1MeasureInstanceIndex OBJECT-TYPE
    SYNTAX      Integer32 (1..2147483647)
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "Low-order index of this Measurement Log entry.
        Ordinal of this instance of Measurement Log data
        (NOT bounded by the value of tudaV1MeasureInstances).

        DEFVAL intentionally omitted - index object."
    ::= { tudaV1MeasureEntry 2 }

tudaV1MeasureData OBJECT-TYPE
    SYNTAX      OCTET STRING (SIZE(0..1024))
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "A instance of CBOR encoded Measurement Log data."
    DEFVAL      { "" }
    ::= { tudaV1MeasureEntry 3 }

--
--  Verify Token
--
tudaV1VerifyToken       OBJECT IDENTIFIER ::= { tudaV1MIBObjects 7 }

tudaV1VerifyTokenCycles OBJECT-TYPE
    SYNTAX      Counter32
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "Count of Verify Token update cycles that have
        occurred.

        DEFVAL intentionally omitted - counter object."
    ::= { tudaV1VerifyToken 1 }

tudaV1VerifyTokenTable OBJECT-TYPE
    SYNTAX      SEQUENCE OF TudaV1VerifyTokenEntry
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "A table of instances of Verify Token data."
    ::= { tudaV1VerifyToken 2 }

tudaV1VerifyTokenEntry OBJECT-TYPE
    SYNTAX      TudaV1VerifyTokenEntry
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "An entry for one instance of Verify Token data."
    INDEX       { tudaV1VerifyTokenCycleIndex }
    ::= { tudaV1VerifyTokenTable 1 }

TudaV1VerifyTokenEntry ::=
    SEQUENCE {
        tudaV1VerifyTokenCycleIndex     Integer32,
        tudaV1VerifyTokenData           OCTET STRING
    }

tudaV1VerifyTokenCycleIndex OBJECT-TYPE
    SYNTAX      Integer32 (1..2147483647)
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "Index of this instance of Verify Token data.
        Index of a Verify Token update cycle that has
        occurred (bounded by the value of tudaV1VerifyTokenCycles).

        DEFVAL intentionally omitted - index object."
    ::= { tudaV1VerifyTokenEntry 1 }

tudaV1VerifyTokenData OBJECT-TYPE
    SYNTAX      OCTET STRING (SIZE(0..1024))
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "A instance of CBOR encoded Verify Token data."
    DEFVAL      { "" }
    ::= { tudaV1VerifyTokenEntry 2 }

--
--  SWID Tag
--
tudaV1SWIDTag           OBJECT IDENTIFIER ::= { tudaV1MIBObjects 8 }

tudaV1SWIDTagCycles OBJECT-TYPE
    SYNTAX      Counter32
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "Count of SWID Tag update cycles that have occurred.

        DEFVAL intentionally omitted - counter object."
    ::= { tudaV1SWIDTag 1 }

tudaV1SWIDTagTable OBJECT-TYPE
    SYNTAX      SEQUENCE OF TudaV1SWIDTagEntry
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "A table of fragments of SWID Tag data."
    ::= { tudaV1SWIDTag 2 }

tudaV1SWIDTagEntry OBJECT-TYPE
    SYNTAX      TudaV1SWIDTagEntry
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "An entry for one fragment of SWID Tag data."
    INDEX       { tudaV1SWIDTagCycleIndex,
                  tudaV1SWIDTagInstanceIndex,
                  tudaV1SWIDTagFragmentIndex }
    ::= { tudaV1SWIDTagTable 1 }

TudaV1SWIDTagEntry ::=
    SEQUENCE {
        tudaV1SWIDTagCycleIndex         Integer32,
        tudaV1SWIDTagInstanceIndex      Integer32,
        tudaV1SWIDTagFragmentIndex      Integer32,
        tudaV1SWIDTagData               OCTET STRING
    }

tudaV1SWIDTagCycleIndex OBJECT-TYPE
    SYNTAX      Integer32 (1..2147483647)
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "High-order index of this SWID Tag fragment.
        Index of an SWID Tag update cycle that has
        occurred (bounded by the value of tudaV1SWIDTagCycles).

        DEFVAL intentionally omitted - index object."
    ::= { tudaV1SWIDTagEntry 1 }

tudaV1SWIDTagInstanceIndex OBJECT-TYPE
    SYNTAX      Integer32 (1..2147483647)
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "Middle index of this SWID Tag fragment.
        Ordinal of this SWID Tag instance in this update cycle.

        DEFVAL intentionally omitted - index object."
    ::= { tudaV1SWIDTagEntry 2 }

tudaV1SWIDTagFragmentIndex OBJECT-TYPE
    SYNTAX      Integer32 (1..2147483647)
    MAX-ACCESS  not-accessible
    STATUS      current
    DESCRIPTION
        "Low-order index of this SWID Tag fragment.

        DEFVAL intentionally omitted - index object."
    ::= { tudaV1SWIDTagEntry 3 }

tudaV1SWIDTagData OBJECT-TYPE
    SYNTAX      OCTET STRING (SIZE(0..1024))
    MAX-ACCESS  read-only
    STATUS      current
    DESCRIPTION
        "A fragment of CBOR encoded SWID Tag data."
    DEFVAL      { "" }
    ::= { tudaV1SWIDTagEntry 4 }

--
--  Trap Cycles
--
tudaV1TrapV2Cycles NOTIFICATION-TYPE
    OBJECTS {
        tudaV1GeneralCycles,
        tudaV1AIKCertCycles,
        tudaV1TSACertCycles,
        tudaV1SyncTokenCycles,
        tudaV1SyncTokenInstances,
        tudaV1RestrictCycles,
        tudaV1MeasureCycles,
        tudaV1MeasureInstances,
        tudaV1VerifyTokenCycles,
        tudaV1SWIDTagCycles
    }
    STATUS  current
    DESCRIPTION
        "This trap is sent when the value of any cycle or instance
        counter changes (i.e., one or more tables are updated).

        Note:  The value of sysUpTime in IETF MIB-II (RFC 1213) is
        always included in SNMPv2 traps, per RFC 3416."
    ::= { tudaV1MIBNotifications 1 }

--
--  Conformance Information
--
tudaV1Compliances           OBJECT IDENTIFIER
    ::= { tudaV1MIBConformance 1 }

tudaV1ObjectGroups          OBJECT IDENTIFIER
    ::= { tudaV1MIBConformance 2 }

tudaV1NotificationGroups    OBJECT IDENTIFIER
    ::= { tudaV1MIBConformance 3 }

--
--  Compliance Statements
--
tudaV1BasicCompliance MODULE-COMPLIANCE
    STATUS  current
    DESCRIPTION
        "An implementation that complies with this module MUST
        implement all of the objects defined in the mandatory
        group tudaV1BasicGroup."
    MODULE  -- this module
    MANDATORY-GROUPS { tudaV1BasicGroup }

    GROUP   tudaV1OptionalGroup
    DESCRIPTION
        "The optional TUDA MIB objects.
        An implementation MAY implement this group."

    GROUP   tudaV1TrapGroup
    DESCRIPTION
        "The TUDA MIB traps.
        An implementation SHOULD implement this group."
    ::= { tudaV1Compliances 1 }

--
--  Compliance Groups
--
tudaV1BasicGroup OBJECT-GROUP
    OBJECTS {
        tudaV1GeneralCycles,
        tudaV1GeneralVersionInfo,
        tudaV1SyncTokenCycles,
        tudaV1SyncTokenInstances,
        tudaV1SyncTokenData,
        tudaV1RestrictCycles,
        tudaV1RestrictData,
        tudaV1VerifyTokenCycles,
        tudaV1VerifyTokenData
    }
    STATUS  current
    DESCRIPTION
        "The basic mandatory TUDA MIB objects."
    ::= { tudaV1ObjectGroups 1 }

tudaV1OptionalGroup OBJECT-GROUP
    OBJECTS {
        tudaV1AIKCertCycles,
        tudaV1AIKCertData,
        tudaV1TSACertCycles,
        tudaV1TSACertData,
        tudaV1MeasureCycles,
        tudaV1MeasureInstances,
        tudaV1MeasureData,
        tudaV1SWIDTagCycles,
        tudaV1SWIDTagData
    }
    STATUS  current
    DESCRIPTION
        "The optional TUDA MIB objects."
    ::= { tudaV1ObjectGroups 2 }

tudaV1TrapGroup NOTIFICATION-GROUP
    NOTIFICATIONS { tudaV1TrapV2Cycles }
    STATUS      current
    DESCRIPTION
        "The recommended TUDA MIB traps - notifications."
    ::= { tudaV1NotificationGroups 1 }

END

&lt;CODE ENDS&gt;</pre><a href="#appendix-B.5-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="yang">
<section id="appendix-C">
      <h2 id="name-yang-realization">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-yang-realization" class="section-name selfRef">YANG Realization</a>
      </h2>
<div id="appendix-C-1">
<pre class="breakable lang-yang sourcecode">&lt;CODE BEGINS&gt;
=============== NOTE: '\' line wrapping per RFC 8792 ================

module TUDA-V1-ATTESTATION-MIB {

  namespace "urn:ietf:params:xml:ns:yang:smiv2:TUDA-V1-ATTESTATION-\
                                                                MIB";
  prefix "tuda-v1";

  import SNMP-FRAMEWORK-MIB { prefix "snmp-framework"; }
  import yang-types         { prefix "yang"; }

  organization
   "Fraunhofer SIT";

  contact
   "Andreas Fuchs
    Fraunhofer Institute for Secure Information Technology
    Email: andreas.fuchs@sit.fraunhofer.de

    Henk Birkholz
    Fraunhofer Institute for Secure Information Technology
    Email: henk.birkholz@sit.fraunhofer.de

    Ira E McDonald
    High North Inc
    Email: blueroofmusic@gmail.com

    Carsten Bormann
    Universitaet Bremen TZI
    Email: cabo@tzi.org";

  description
   "The MIB module for monitoring of time-based unidirectional
    attestation information from a network endpoint system,
    based on the Trusted Computing Group TPM 1.2 definition.

    Copyright (C) High North Inc (2021).";

  revision "2021-01-13" {
    description
     "Twelfth version, published as draft-birkholz-rats-tuda-04.";
    reference
     "draft-birkholz-rats-tuda-04";
  }
  revision "2020-07-13" {
    description
     "Eleventh version, published as draft-birkholz-rats-tuda-03.";
    reference
     "draft-birkholz-rats-tuda-03";
  }
  revision "2020-03-09" {
    description
     "Tenth version, published as draft-birkholz-rats-tuda-02.";
    reference
     "draft-birkholz-rats-tuda-02";
  }
  revision "2019-09-11" {
    description
     "Ninth version, published as draft-birkholz-rats-tuda-01.";
    reference
     "draft-birkholz-rats-tuda-01";
  }
  revision "2019-03-12" {
    description
     "Eighth version, published as draft-birkholz-rats-tuda-00.";
    reference
     "draft-birkholz-rats-tuda-00";
  }
  revision "2018-05-03" {
    description
     "Seventh version, published as draft-birkholz-i2nsf-tuda-03.";
    reference
     "draft-birkholz-i2nsf-tuda-03";
  }
  revision "2018-05-02" {
    description
     "Sixth version, published as draft-birkholz-i2nsf-tuda-02.";
    reference
     "draft-birkholz-i2nsf-tuda-02";
  }
  revision "2017-10-30" {
    description
     "Fifth version, published as draft-birkholz-i2nsf-tuda-01.";
    reference
     "draft-birkholz-i2nsf-tuda-01";
  }
  revision "2017-01-09" {
    description
     "Fourth version, published as draft-birkholz-i2nsf-tuda-00.";
    reference
     "draft-birkholz-i2nsf-tuda-00";
  }
  revision "2016-07-08" {
    description
     "Third version, published as draft-birkholz-tuda-02.";
    reference
     "draft-birkholz-tuda-02";
  }
  revision "2016-03-21" {
    description
     "Second version, published as draft-birkholz-tuda-01.";
    reference
     "draft-birkholz-tuda-01";
  }
  revision "2015-10-18" {
    description
     "Initial version, published as draft-birkholz-tuda-00.";
    reference
     "draft-birkholz-tuda-00";
  }

  container tudaV1General {
  description
    "TBD";

    leaf tudaV1GeneralCycles {
      type yang:counter32;
      config false;
      description
       "Count of TUDA update cycles that have occurred, i.e.,
        sum of all the individual group cycle counters.

        DEFVAL intentionally omitted - counter object.";
    }

    leaf tudaV1GeneralVersionInfo {
      type snmp-framework:SnmpAdminString {
        length "0..255";
      }
      config false;
      description
       "Version information for TUDA MIB, e.g., specific release
        version of TPM 1.2 base specification and release version
        of TPM 1.2 errata specification and manufacturer and model
        TPM module itself.";
    }
  }

  container tudaV1AIKCert {
  description
    "TBD";

    leaf tudaV1AIKCertCycles {
      type yang:counter32;
      config false;
      description
       "Count of AIK Certificate chain update cycles that have
        occurred.

        DEFVAL intentionally omitted - counter object.";
    }

    /* XXX table comments here XXX */

    list tudaV1AIKCertEntry {

      key "tudaV1AIKCertCycleIndex tudaV1AIKCertInstanceIndex
           tudaV1AIKCertFragmentIndex";
        config false;
      description
       "An entry for one fragment of AIK Certificate data.";


      leaf tudaV1AIKCertCycleIndex {
        type int32 {
          range "1..2147483647";
        }
        config false;
        description
         "High-order index of this AIK Certificate fragment.
          Index of an AIK Certificate chain update cycle that has
          occurred (bounded by the value of tudaV1AIKCertCycles).

          DEFVAL intentionally omitted - index object.";
      }

      leaf tudaV1AIKCertInstanceIndex {
        type int32 {
          range "1..2147483647";
        }
        config false;
        description
         "Middle index of this AIK Certificate fragment.
          Ordinal of this AIK Certificate in this chain, where the \
                                                                  AIK
          Certificate itself has an ordinal of '1' and higher \
                                                             ordinals
          go *up* the certificate chain to the Root CA.

          DEFVAL intentionally omitted - index object.";
      }

      leaf tudaV1AIKCertFragmentIndex {
        type int32 {
          range "1..2147483647";
        }
        config false;
        description
         "Low-order index of this AIK Certificate fragment.

          DEFVAL intentionally omitted - index object.";
      }

      leaf tudaV1AIKCertData {
        type binary {
          length "0..1024";
        }
        config false;
        description
         "A fragment of CBOR encoded AIK Certificate data.";
      }
    }
  }

  container tudaV1TSACert {
  description
    "TBD";

    leaf tudaV1TSACertCycles {
      type yang:counter32;
      config false;
      description
       "Count of TSA Certificate chain update cycles that have
        occurred.

        DEFVAL intentionally omitted - counter object.";
    }


    /* XXX table comments here XXX */

    list tudaV1TSACertEntry {

      key "tudaV1TSACertCycleIndex tudaV1TSACertInstanceIndex
           tudaV1TSACertFragmentIndex";
      config false;
      description
       "An entry for one fragment of TSA Certificate data.";


      leaf tudaV1TSACertCycleIndex {
        type int32 {
          range "1..2147483647";
        }
        config false;
        description
         "High-order index of this TSA Certificate fragment.
          Index of a TSA Certificate chain update cycle that has
          occurred (bounded by the value of tudaV1TSACertCycles).

          DEFVAL intentionally omitted - index object.";
      }

      leaf tudaV1TSACertInstanceIndex {
        type int32 {
          range "1..2147483647";
        }
        config false;
        description
         "Middle index of this TSA Certificate fragment.
          Ordinal of this TSA Certificate in this chain, where the \
                                                                  TSA
          Certificate itself has an ordinal of '1' and higher \
                                                             ordinals
          go *up* the certificate chain to the Root CA.

          DEFVAL intentionally omitted - index object.";
      }

      leaf tudaV1TSACertFragmentIndex {
        type int32 {
          range "1..2147483647";
        }
        config false;
        description
         "Low-order index of this TSA Certificate fragment.

          DEFVAL intentionally omitted - index object.";
      }

      leaf tudaV1TSACertData {
        type binary {
          length "0..1024";
        }
        config false;
        description
         "A fragment of CBOR encoded TSA Certificate data.";
      }
    }
  }

  container tudaV1SyncToken {
  description
    "TBD";

    leaf tudaV1SyncTokenCycles {
      type yang:counter32;
      config false;
      description
       "Count of Sync Token update cycles that have
        occurred.

        DEFVAL intentionally omitted - counter object.";
    }

    leaf tudaV1SyncTokenInstances {
      type yang:counter32;
      config false;
      description
       "Count of Sync Token instance entries that have
        been recorded (some entries MAY have been pruned).

        DEFVAL intentionally omitted - counter object.";
    }

    list tudaV1SyncTokenEntry {

      key "tudaV1SyncTokenCycleIndex
           tudaV1SyncTokenInstanceIndex
           tudaV1SyncTokenFragmentIndex";
      config false;
      description
       "An entry for one fragment of Sync Token data.";


      leaf tudaV1SyncTokenCycleIndex {
        type int32 {
          range "1..2147483647";
        }
        config false;
        description
         "High-order index of this Sync Token fragment.
          Index of a Sync Token update cycle that has
          occurred (bounded by the value of tudaV1SyncTokenCycles).

          DEFVAL intentionally omitted - index object.";
      }

      leaf tudaV1SyncTokenInstanceIndex {
        type int32 {
          range "1..2147483647";
        }
        config false;
        description
         "Middle index of this Sync Token fragment.
          Ordinal of this instance of Sync Token data
          (NOT bounded by the value of tudaV1SyncTokenInstances).

          DEFVAL intentionally omitted - index object.";
      }

      leaf tudaV1SyncTokenFragmentIndex {
        type int32 {
          range "1..2147483647";
        }
        config false;
        description
         "Low-order index of this Sync Token fragment.

          DEFVAL intentionally omitted - index object.";
      }

      leaf tudaV1SyncTokenData {
        type binary {
          length "0..1024";
        }
        config false;
        description
         "A fragment of CBOR encoded Sync Token data.";
      }
    }
  }

  container tudaV1Restrict {
  description
    "TBD";

    leaf tudaV1RestrictCycles {
      type yang:counter32;
      config false;
      description
       "Count of Restriction Info update cycles that have
        occurred.

        DEFVAL intentionally omitted - counter object.";
    }


    /* XXX table comments here XXX */

    list tudaV1RestrictEntry {

      key "tudaV1RestrictCycleIndex";
      config false;
      description
       "An entry for one instance of Restriction Info data.";


      leaf tudaV1RestrictCycleIndex {
        type int32 {
          range "1..2147483647";
        }
        config false;
        description
         "Index of this Restriction Info entry.
          Index of a Restriction Info update cycle that has
          occurred (bounded by the value of tudaV1RestrictCycles).

          DEFVAL intentionally omitted - index object.";
      }

      leaf tudaV1RestrictData {
        type binary {
          length "0..1024";
        }
        config false;
        description
         "An instance of CBOR encoded Restriction Info data.";
      }
    }
  }

  container tudaV1Measure {
  description
    "TBD";

    leaf tudaV1MeasureCycles {
      type yang:counter32;
      config false;
      description
       "Count of Measurement Log update cycles that have
        occurred.

        DEFVAL intentionally omitted - counter object.";
    }

    leaf tudaV1MeasureInstances {
      type yang:counter32;
      config false;
      description
       "Count of Measurement Log instance entries that have
        been recorded (some entries MAY have been pruned).

        DEFVAL intentionally omitted - counter object.";
    }

    list tudaV1MeasureEntry {

      key "tudaV1MeasureCycleIndex tudaV1MeasureInstanceIndex";
      config false;
      description
       "An entry for one instance of Measurement Log data.";


      leaf tudaV1MeasureCycleIndex {
        type int32 {
          range "1..2147483647";
        }
        config false;
        description
         "High-order index of this Measurement Log entry.
          Index of a Measurement Log update cycle that has
          occurred (bounded by the value of tudaV1MeasureCycles).

          DEFVAL intentionally omitted - index object.";
      }

      leaf tudaV1MeasureInstanceIndex {
        type int32 {
          range "1..2147483647";
        }
        config false;
        description
         "Low-order index of this Measurement Log entry.
          Ordinal of this instance of Measurement Log data
          (NOT bounded by the value of tudaV1MeasureInstances).

          DEFVAL intentionally omitted - index object.";
      }

      leaf tudaV1MeasureData {
        type binary {
          length "0..1024";
        }
        config false;
        description
         "A instance of CBOR encoded Measurement Log data.";
      }
    }
  }

  container tudaV1VerifyToken {
  description
    "TBD";

    leaf tudaV1VerifyTokenCycles {
      type yang:counter32;
      config false;
      description
       "Count of Verify Token update cycles that have
        occurred.

        DEFVAL intentionally omitted - counter object.";
    }


    /* XXX table comments here XXX */

    list tudaV1VerifyTokenEntry {

      key "tudaV1VerifyTokenCycleIndex";
      config false;
      description
       "An entry for one instance of Verify Token data.";


      leaf tudaV1VerifyTokenCycleIndex {
        type int32 {
          range "1..2147483647";
        }
        config false;
        description
         "Index of this instance of Verify Token data.
          Index of a Verify Token update cycle that has
          occurred (bounded by the value of tudaV1VerifyTokenCycles).

          DEFVAL intentionally omitted - index object.";
      }

      leaf tudaV1VerifyTokenData {
        type binary {
          length "0..1024";
        }
        config false;
        description
         "A instanc-V1-ATTESTATION-MIB.yang
      }
    }
  }

  container tudaV1SWIDTag {
  description
    "see CoSWID and YANG SIWD module for now"

    leaf tudaV1SWIDTagCycles {
      type yang:counter32;
      config false;
      description
       "Count of SWID Tag update cycles that have occurred.

        DEFVAL intentionally omitted - counter object.";
    }

    list tudaV1SWIDTagEntry {

      key "tudaV1SWIDTagCycleIndex tudaV1SWIDTagInstanceIndex
           tudaV1SWIDTagFragmentIndex";
      config false;
      description
       "An entry for one fragment of SWID Tag data.";


      leaf tudaV1SWIDTagCycleIndex {
        type int32 {
          range "1..2147483647";
        }
        config false;
        description
         "High-order index of this SWID Tag fragment.
          Index of an SWID Tag update cycle that has
          occurred (bounded by the value of tudaV1SWIDTagCycles).

          DEFVAL intentionally omitted - index object.";
      }

      leaf tudaV1SWIDTagInstanceIndex {
        type int32 {
          range "1..2147483647";
        }
        config false;
        description
         "Middle index of this SWID Tag fragment.
          Ordinal of this SWID Tag instance in this update cycle.

          DEFVAL intentionally omitted - index object.";
      }

      leaf tudaV1SWIDTagFragmentIndex {
        type int32 {
          range "1..2147483647";
        }
        config false;
        description
         "Low-order index of this SWID Tag fragment.

          DEFVAL intentionally omitted - index object.";
      }

      leaf tudaV1SWIDTagData {
        type binary {
          length "0..1024";
        }
        config false;
        description
         "A fragment of CBOR encoded SWID Tag data.";
      }
    }
  }

  notification tudaV1TrapV2Cycles {
    description
     "This trap is sent when the value of any cycle or instance
      counter changes (i.e., one or more tables are updated).

      Note:  The value of sysUpTime in IETF MIB-II (RFC 1213) is
      always included in SNMPv2 traps, per RFC 3416.";

    container tudaV1TrapV2Cycles-tudaV1GeneralCycles {
      description
       "TPD"
      leaf tudaV1GeneralCycles {
        type yang:counter32;
        description
         "Count of TUDA update cycles that have occurred, i.e.,
          sum of all the individual group cycle counters.

          DEFVAL intentionally omitted - counter object.";
      }
    }

    container tudaV1TrapV2Cycles-tudaV1AIKCertCycles {
      description
       "TPD"
      leaf tudaV1AIKCertCycles {
        type yang:counter32;
        description
         "Count of AIK Certificate chain update cycles that have
          occurred.

          DEFVAL intentionally omitted - counter object.";
      }
    }

    container tudaV1TrapV2Cycles-tudaV1TSACertCycles {
      description
       "TPD"
      leaf tudaV1TSACertCycles {
        type yang:counter32;
        description
         "Count of TSA Certificate chain update cycles that have
          occurred.

          DEFVAL intentionally omitted - counter object.";
      }
    }

    container tudaV1TrapV2Cycles-tudaV1SyncTokenCycles {
      description
       "TPD"
      leaf tudaV1SyncTokenCycles {
        type yang:counter32;
        description
         "Count of Sync Token update cycles that have
          occurred.

          DEFVAL intentionally omitted - counter object.";
      }
    }

    container tudaV1TrapV2Cycles-tudaV1SyncTokenInstances {
      description
       "TPD"
      leaf tudaV1SyncTokenInstances {
        type yang:counter32;
        description
         "Count of Sync Token instance entries that have
          been recorded (some entries MAY have been pruned).

          DEFVAL intentionally omitted - counter object.";
      }
    }

    container tudaV1TrapV2Cycles-tudaV1RestrictCycles {
      description
       "TPD"
      leaf tudaV1RestrictCycles {
        type yang:counter32;
        description
         "Count of Restriction Info update cycles that have
          occurred.

          DEFVAL intentionally omitted - counter object.";
      }
    }

    container tudaV1TrapV2Cycles-tudaV1MeasureCycles {
      description
       "TPD"
      leaf tudaV1MeasureCycles {
        type yang:counter32;
        description
         "Count of Measurement Log update cycles that have
          occurred.

          DEFVAL intentionally omitted - counter object.";
      }
    }

    container tudaV1TrapV2Cycles-tudaV1MeasureInstances {
      description
       "TPD"
      leaf tudaV1MeasureInstances {
        type yang:counter32;
        description
         "Count of Measurement Log instance entries that have
          been recorded (some entries MAY have been pruned).

          DEFVAL intentionally omitted - counter object.";
      }
    }

    container tudaV1TrapV2Cycles-tudaV1VerifyTokenCycles {
      description
       "TPD"
      leaf tudaV1VerifyTokenCycles {
        type yang:counter32;
        description
         "Count of Verify Token update cycles that have
          occurred.

          DEFVAL intentionally omitted - counter object.";
      }
    }

    container tudaV1TrapV2Cycles-tudaV1SWIDTagCycles {
      description
       "TPD"
      leaf tudaV1SWIDTagCycles {
        type yang:counter32;
        description
         "Count of SWID Tag update cycles that have occurred.

          DEFVAL intentionally omitted - counter object.";
      }
    }

  }
}

&lt;CODE ENDS&gt;</pre><a href="#appendix-C-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="realization-with-tpm-functions">
<section id="appendix-D">
      <h2 id="name-realization-with-tpm-functi">
<a href="#appendix-D" class="section-number selfRef">Appendix D. </a><a href="#name-realization-with-tpm-functi" class="section-name selfRef">Realization with TPM functions</a>
      </h2>
<div id="tpm-functions">
<section id="appendix-D.1">
        <h3 id="name-tpm-functions">
<a href="#appendix-D.1" class="section-number selfRef">D.1. </a><a href="#name-tpm-functions" class="section-name selfRef">TPM Functions</a>
        </h3>
<p id="appendix-D.1-1">The following TPM structures, resources and functions are used within this approach.
They are based upon the TPM specifications <span>[<a href="#TPM12" class="xref">TPM12</a>]</span> and <span>[<a href="#TPM2" class="xref">TPM2</a>]</span>.<a href="#appendix-D.1-1" class="pilcrow">¶</a></p>
<div id="tick-session-and-tick-stamp">
<section id="appendix-D.1.1">
          <h4 id="name-tick-session-and-tick-stamp">
<a href="#appendix-D.1.1" class="section-number selfRef">D.1.1. </a><a href="#name-tick-session-and-tick-stamp" class="section-name selfRef">Tick-Session and Tick-Stamp</a>
          </h4>
<p id="appendix-D.1.1-1">On every boot, the TPM initializes a new Tick-Session. Such a tick-session consists
of a nonce that is randomly created upon each boot to identify the current boot-cycle
-- the phase between boot-time of the device and shutdown or power-off --
and prevent replaying of old tick-session values. The TPM uses its internal entropy
source that guarantees virtually no collisions of the nonce values between two of such
boot cycles.<a href="#appendix-D.1.1-1" class="pilcrow">¶</a></p>
<p id="appendix-D.1.1-2">It further includes an internal timer that is being initialize to Zero on each
reboot. From this point on, the TPM increments this timer continuously based upon its
internal secure clocking information until the device is powered down or set to sleep.
By its hardware design, the TPM will detect attacks on any of those properties.<a href="#appendix-D.1.1-2" class="pilcrow">¶</a></p>
<p id="appendix-D.1.1-3">The TPM offers the function TPM_TickStampBlob, which allows the TPM to create a signature
over the current tick-session and two externally provided input values. These input values
are designed to serve as a nonce and as payload data to be included in a TickStampBlob:
TickstampBlob := sig(TPM-key, currentTicks || nonce || externalData).<a href="#appendix-D.1.1-3" class="pilcrow">¶</a></p>
<p id="appendix-D.1.1-4">As a result,
one is able to proof that at a certain point in time (relative to the tick-session)
after the provisioning of a certain nonce, some certain externalData was known and
provided to the TPM. If an approach however requires no input values or only one
input value (such as the use in this document) the input values can be set to well-known
value. The convention used within TCG specifications and within this document is to
use twenty bytes of zero h'0000000000000000000000000000000000000000' as well-known
value.<a href="#appendix-D.1.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="platform-configuration-registers-pcrs">
<section id="appendix-D.1.2">
          <h4 id="name-platform-configuration-regi">
<a href="#appendix-D.1.2" class="section-number selfRef">D.1.2. </a><a href="#name-platform-configuration-regi" class="section-name selfRef">Platform Configuration Registers (PCRs)</a>
          </h4>
<p id="appendix-D.1.2-1">The TPM is a secure cryptoprocessor that provides the ability to store measurements
and metrics about an endpoint's configuration and state in a secure, tamper-proof
environment. Each of these security relevant metrics can be stored in a volatile
Platform Configuration Register (PCR) inside the TPM. These measurements can be
conducted at any point in time, ranging from an initial BIOS boot-up sequence to
measurements taken after hundreds of hours of uptime.<a href="#appendix-D.1.2-1" class="pilcrow">¶</a></p>
<p id="appendix-D.1.2-2">The initial measurement is triggered by the Platforms so-called pre-BIOS or ROM-code.
It will conduct a measurement of the first loadable pieces of code; i.e.\ the BIOS.
The BIOS will in turn measure its Option ROMs and the BootLoader, which measures the
OS-Kernel, which in turn measures its applications. This describes a so-called measurement
chain. This typically gets recorded in a so-called measurement log, such that the
values of the PCRs can be reconstructed from the individual measurements for validation.<a href="#appendix-D.1.2-2" class="pilcrow">¶</a></p>
<p id="appendix-D.1.2-3">Via its PCRs, a TPM provides a Root of Trust that can, for example, support secure
boot or remote attestation. The attestation of an endpoint's identity or security
posture is based on the content of an TPM's PCRs (platform integrity measurements).<a href="#appendix-D.1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pcr-restricted-keys">
<section id="appendix-D.1.3">
          <h4 id="name-pcr-restricted-keys">
<a href="#appendix-D.1.3" class="section-number selfRef">D.1.3. </a><a href="#name-pcr-restricted-keys" class="section-name selfRef">PCR restricted Keys</a>
          </h4>
<p id="appendix-D.1.3-1">Every key inside the TPM can be restricted in such a way that it can only be used
if a certain set of PCRs are in a predetermined state. For key creation the desired
state for PCRs are defined via the PCRInfo field inside the keyInfo parameter.
Whenever an operation using this key is performed, the TPM first checks whether
the PCRs are in the correct state. Otherwise the operation is denied by the TPM.<a href="#appendix-D.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="certifyinfo">
<section id="appendix-D.1.4">
          <h4 id="name-certifyinfo">
<a href="#appendix-D.1.4" class="section-number selfRef">D.1.4. </a><a href="#name-certifyinfo" class="section-name selfRef">CertifyInfo</a>
          </h4>
<p id="appendix-D.1.4-1">The TPM offers a command to certify the properties of a key by means of a signature
using another key. This includes especially the keyInfo which in turn includes the PCRInfo information
used during key creation. This way, a third party can be assured about the fact that
a key is only usable if the PCRs are in a certain state.<a href="#appendix-D.1.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="tpm12">
<section id="appendix-D.2">
        <h3 id="name-ie-generation-procedures-fo">
<a href="#appendix-D.2" class="section-number selfRef">D.2. </a><a href="#name-ie-generation-procedures-fo" class="section-name selfRef">IE Generation Procedures for TPM 1.2</a>
        </h3>
<div id="aik">
<section id="appendix-D.2.1">
          <h4 id="name-aik-and-aik-certificate">
<a href="#appendix-D.2.1" class="section-number selfRef">D.2.1. </a><a href="#name-aik-and-aik-certificate" class="section-name selfRef">AIK and AIK Certificate</a>
          </h4>
<p id="appendix-D.2.1-1">Attestations are based upon a cryptographic signature performed by the TPM using
a so-called Attestation Identity Key (AIK). An AIK has the properties that it cannot
be exported from a TPM and is used for attestations. Trust in the AIK is established
by an X.509 Certificate emitted by a Certificate Authority. The AIK certificate is
either provided directly or via a so-called PrivacyCA <span>[<a href="#AIK-Enrollment" class="xref">AIK-Enrollment</a>]</span>.<a href="#appendix-D.2.1-1" class="pilcrow">¶</a></p>
<p id="appendix-D.2.1-2">This element consists of the AIK certificate that includes the AIK's public key used
during verification as well as the certificate chain up to the Root CA for validation
of the AIK certificate itself.<a href="#appendix-D.2.1-2" class="pilcrow">¶</a></p>
<span id="name-tuda-cert-element-in-cddl"></span><div id="cert-token">
<figure id="figure-2">
            <div id="appendix-D.2.1-3.1">
<pre class="lang-cddl sourcecode">
TUDA-Cert = [AIK-Cert, TSA-Cert]; maybe split into two for SNMP
AIK-Cert = Cert
TSA-Cert = Cert
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-tuda-cert-element-in-cddl" class="selfRef">TUDA-Cert element in CDDL</a>
            </figcaption></figure>
</div>
<p id="appendix-D.2.1-4">The TSA-Cert is a standard certificate of the TSA.<a href="#appendix-D.2.1-4" class="pilcrow">¶</a></p>
<p id="appendix-D.2.1-5">The AIK-Cert may be provisioned in a secure environment using standard means or
it may follow the PrivacyCA protocols. <a href="#make-cert-token" class="xref">Figure 3</a> gives a rough sketch
of this protocol. See <span>[<a href="#AIK-Enrollment" class="xref">AIK-Enrollment</a>]</span> for more information.<a href="#appendix-D.2.1-5" class="pilcrow">¶</a></p>
<p id="appendix-D.2.1-6">The X.509 Certificate is built from the AIK public key and the
corresponding PKCS #7 certificate chain, as shown in
<a href="#make-cert-token" class="xref">Figure 3</a>.<a href="#appendix-D.2.1-6" class="pilcrow">¶</a></p>
<p id="appendix-D.2.1-7">Required TPM functions:<a href="#appendix-D.2.1-7" class="pilcrow">¶</a></p>
<span id="name-creating-the-tuda-cert-elem"></span><div id="make-cert-token">
<figure id="figure-3">
            <div id="appendix-D.2.1-8.1">
<pre class="lang-pseudocode sourcecode">
| create_AIK_Cert(...) = {
|   AIK = TPM_MakeIdentity()
|   IdReq = CollateIdentityRequest(AIK,EK)
|   IdRes = Call(AIK-CA, IdReq)
|   AIK-Cert = TPM_ActivateIdentity(AIK, IdRes)
| }
|
| /* Alternative */
|
| create_AIK_Cert(...) = {
|   AIK = TPM_CreateWrapKey(Identity)
|   AIK-Cert = Call(AIK-CA, AIK.pubkey)
| }
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-creating-the-tuda-cert-elem" class="selfRef">Creating the TUDA-Cert element</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="synchronization-token">
<section id="appendix-D.2.2">
          <h4 id="name-synchronization-token">
<a href="#appendix-D.2.2" class="section-number selfRef">D.2.2. </a><a href="#name-synchronization-token" class="section-name selfRef">Synchronization Token</a>
          </h4>
<p id="appendix-D.2.2-1">The reference for Attestations are the Tick-Sessions of the TPM. In order to put Attestations
into relation with a Real Time Clock (RTC), it is necessary to provide a cryptographic
synchronization between the tick session and the RTC. To do so, a synchronization
protocol is run with a Time Stamp Authority (TSA) that consists of three steps:<a href="#appendix-D.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D.2.2-2.1">The TPM creates a TickStampBlob using the AIK<a href="#appendix-D.2.2-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-D.2.2-2.2">This TickStampBlob is used as nonce to the Timestamp of the TSA<a href="#appendix-D.2.2-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-D.2.2-2.3">Another TickStampBlob with the AIK is created using the TSA's Timestamp a nonce<a href="#appendix-D.2.2-2.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="appendix-D.2.2-3">The first TickStampBlob is called "left" and the second "right" in a reference to
their position on a time-axis.<a href="#appendix-D.2.2-3" class="pilcrow">¶</a></p>
<p id="appendix-D.2.2-4">These three elements, with the TSA's certificate factored out, form
the synchronization token<a href="#appendix-D.2.2-4" class="pilcrow">¶</a></p>
<span id="name-tuda-sync-element-in-cddl"></span><div id="sync-token">
<figure id="figure-4">
            <div id="appendix-D.2.2-5.1">
<pre class="lang-cddl sourcecode">
TUDA-Synctoken = [
  left: TickStampBlob-Output,
  timestamp: TimeStampToken,
  right: TickStampBlob-Output,
]

TimeStampToken = bytes ; RFC 3161

TickStampBlob-Output = [
  currentTicks: TPM-CURRENT-TICKS,
  sig: bytes,
]

TPM-CURRENT-TICKS = [
  currentTicks: uint
  ? (
    tickRate: uint
    tickNonce: TPM-NONCE
  )
]
; Note that TickStampBlob-Output "right" can omit the values for
;   tickRate and tickNonce since they are the same as in "left"

TPM-NONCE = bytes .size 20
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-tuda-sync-element-in-cddl" class="selfRef">TUDA-Sync element in CDDL</a>
            </figcaption></figure>
</div>
<p id="appendix-D.2.2-6">Required TPM functions:<a href="#appendix-D.2.2-6" class="pilcrow">¶</a></p>
<span id="name-creating-the-sync-token-ele"></span><div id="make-sync-token">
<figure id="figure-5">
            <div id="appendix-D.2.2-7.1">
<pre class="lang-pseudocode sourcecode">
| dummyDigest = h'0000000000000000000000000000000000000000'
| dummyNonce = dummyDigest
|
| create_sync_token(AIKHandle, TSA) = {
|   ts_left = TPM_TickStampBlob(
|       keyHandle = AIK_Handle,      /*TPM_KEY_HANDLE*/
|       antiReplay = dummyNonce,     /*TPM_NONCE*/
|       digestToStamp = dummyDigest  /*TPM_DIGEST*/)
|
|   ts = TSA_Timestamp(TSA, nonce = hash(ts_left))
|
|   ts_right = TPM_TickStampBlob(
|       keyHandle = AIK_Handle,      /*TPM_KEY_HANDLE*/
|       antiReplay = dummyNonce,     /*TPM_NONCE*/
|       digestToStamp = hash(ts))    /*TPM_DIGEST*/
|
|   TUDA-SyncToken = [[ts_left.ticks, ts_left.sig], ts,
|                     [ts_right.ticks.currentTicks, ts_right.sig]]
|   /* Note: skip the nonce and tickRate field for ts_right.ticks */
| }

</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-creating-the-sync-token-ele" class="selfRef">Creating the Sync-Token element</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="restrictioninfo">
<section id="appendix-D.2.3">
          <h4 id="name-restrictioninfo">
<a href="#appendix-D.2.3" class="section-number selfRef">D.2.3. </a><a href="#name-restrictioninfo" class="section-name selfRef">RestrictionInfo</a>
          </h4>
<p id="appendix-D.2.3-1">The attestation relies on the capability of the TPM to operate on restricted keys.
Whenever the PCR values for the machine to be attested change, a new restricted key
is created that can only be operated as long as the PCRs remain in their current state.<a href="#appendix-D.2.3-1" class="pilcrow">¶</a></p>
<p id="appendix-D.2.3-2">In order to prove to the Verifier that this restricted temporary key actually has
these properties and also to provide the PCR value that it is restricted, the TPM
command TPM_CertifyInfo is used. It creates a signed certificate using the AIK about
the newly created restricted key.<a href="#appendix-D.2.3-2" class="pilcrow">¶</a></p>
<p id="appendix-D.2.3-3">This token is formed from the list of:<a href="#appendix-D.2.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D.2.3-4.1">PCR list,<a href="#appendix-D.2.3-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-D.2.3-4.2">the newly created restricted public key, and<a href="#appendix-D.2.3-4.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-D.2.3-4.3">the certificate.<a href="#appendix-D.2.3-4.3" class="pilcrow">¶</a>
</li>
          </ul>
<span id="name-tuda-key-element-in-cddl"></span><div id="key-token">
<figure id="figure-6">
            <div id="appendix-D.2.3-5.1">
<pre class="breakable lang-cddl sourcecode">
TUDA-RestrictionInfo = [Composite,
                        restrictedKey_Pub: Pubkey,
                        CertifyInfo]

PCRSelection = bytes .size (2..4) ; used as bit string

Composite = [
  bitmask: PCRSelection,
  values: [*PCR-Hash],
]

Pubkey = bytes ; may be extended to COSE pubkeys

CertifyInfo = [
  TPM-CERTIFY-INFO,
  sig: bytes,
]

TPM-CERTIFY-INFO = [
  ; we don't encode TPM-STRUCT-VER:
  ; these are 4 bytes always equal to h'01010000'
  keyUsage: uint, ; 4byte? 2byte?
  keyFlags: bytes .size 4, ; 4byte
  authDataUsage: uint, ; 1byte (enum)
  algorithmParms: TPM-KEY-PARMS,
  pubkeyDigest: Hash,
  ; we don't encode TPM-NONCE data, which is 20 bytes, all zero
  parentPCRStatus: bool,
  ; no need to encode pcrinfosize
  pcrinfo: TPM-PCR-INFO,        ; we have exactly one
]

TPM-PCR-INFO = [
    pcrSelection: PCRSelection; /* TPM_PCR_SELECTION */
    digestAtRelease: PCR-Hash;  /* TPM_COMPOSITE_HASH */
    digestAtCreation: PCR-Hash; /* TPM_COMPOSITE_HASH */
]

TPM-KEY-PARMS = [
  ; algorithmID: uint, ; &lt;= 4 bytes, not encoded, constant for TPM1.2
  encScheme: uint, ; &lt;= 2 bytes
  sigScheme: uint, ; &lt;= 2 bytes
  parms: TPM-RSA-KEY-PARMS,
]

TPM-RSA-KEY-PARMS = [
  ; "size of the RSA key in bits":
  keyLength: uint
  ; "number of prime factors used by this RSA key":
  numPrimes: uint
  ; "This SHALL be the size of the exponent":
  exponentSize: null / uint / biguint
  ; "If the key is using the default exponent then the exponentSize
  ; MUST be 0" -&gt; we represent this case as null
]

</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-tuda-key-element-in-cddl" class="selfRef">TUDA-Key element in CDDL</a>
            </figcaption></figure>
</div>
<p id="appendix-D.2.3-6">Required TPM functions:<a href="#appendix-D.2.3-6" class="pilcrow">¶</a></p>
<span id="name-creating-the-pubkey"></span><div id="make-pubkey">
<figure id="figure-7">
            <div id="appendix-D.2.3-7.1">
<pre class="lang-pseudocode sourcecode">
| dummyDigest = h'0000000000000000000000000000000000000000'
| dummyNonce = dummyDigest
|
| create_Composite
|
| create_restrictedKey_Pub(pcrsel) = {
|   PCRInfo = {pcrSelection = pcrsel,
|              digestAtRelease = hash(currentValues(pcrSelection))
|              digestAtCreation = dummyDigest}
|   / * PCRInfo is a TPM_PCR_INFO and thus also a TPM_KEY */
|
|   wk = TPM_CreateWrapKey(keyInfo = PCRInfo)
|   wk.keyInfo.pubKey
| }
|
| create_TPM-Certify-Info = {
|   CertifyInfo = TPM_CertifyKey(
|       certHandle = AIK,          /* TPM_KEY_HANDLE */
|       keyHandle = wk,            /* TPM_KEY_HANDLE */
|       antiReply = dummyNonce)    /* TPM_NONCE */
|
|   CertifyInfo.strip()
|   /* Remove those values that are not needed */
| }
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-creating-the-pubkey" class="selfRef">Creating the pubkey</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="mlog">
<section id="appendix-D.2.4">
          <h4 id="name-measurement-log">
<a href="#appendix-D.2.4" class="section-number selfRef">D.2.4. </a><a href="#name-measurement-log" class="section-name selfRef">Measurement Log</a>
          </h4>
<p id="appendix-D.2.4-1">Similarly to regular attestations, the Verifier needs a way to reconstruct the PCRs'
values in order to estimate the trustworthiness of the device. As such, a list of
those elements that were extended into the PCRs is reported. Note though that for
certain environments, this step may be optional if a list of valid PCR configurations
exists and no measurement log is required.<a href="#appendix-D.2.4-1" class="pilcrow">¶</a></p>
<div id="appendix-D.2.4-2">
<pre class="lang-cddl sourcecode">
TUDA-Measurement-Log = [*PCR-Event]
PCR-Event = [
  type: PCR-Event-Type,
  pcr: uint,
  template-hash: PCR-Hash,
  filedata-hash: tagged-hash,
  pathname: text; called filename-hint in ima (non-ng)
]

PCR-Event-Type = &amp;(
  bios: 0
  ima: 1
  ima-ng: 2
)

; might want to make use of COSE registry here
; however, that might never define a value for sha1
tagged-hash /= [sha1: 0, bytes .size 20]
tagged-hash /= [sha256: 1, bytes .size 32]
</pre><a href="#appendix-D.2.4-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="impa">
<section id="appendix-D.2.5">
          <h4 id="name-implicit-attestation">
<a href="#appendix-D.2.5" class="section-number selfRef">D.2.5. </a><a href="#name-implicit-attestation" class="section-name selfRef">Implicit Attestation</a>
          </h4>
<p id="appendix-D.2.5-1">The actual attestation is then based upon a TickStampBlob using the restricted
temporary key that was certified in the steps above. The TPM-Tickstamp is executed
and thereby provides evidence that at this point in time (with respect to the TPM
internal tick-session) a certain configuration existed (namely the PCR values associated
with the restricted key). Together with the synchronization token this tick-related
timing can then be related to the real-time clock.<a href="#appendix-D.2.5-1" class="pilcrow">¶</a></p>
<p id="appendix-D.2.5-2">This element consists only of the TPM_TickStampBlock with no nonce.<a href="#appendix-D.2.5-2" class="pilcrow">¶</a></p>
<span id="name-tuda-verify-element-in-cddl"></span><div id="verify-token">
<figure id="figure-8">
            <div id="appendix-D.2.5-3.1">
<pre class="lang-cddl sourcecode">
TUDA-Verifytoken = TickStampBlob-Output
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-tuda-verify-element-in-cddl" class="selfRef">TUDA-Verify element in CDDL</a>
            </figcaption></figure>
</div>
<p id="appendix-D.2.5-4">Required TPM functions:<a href="#appendix-D.2.5-4" class="pilcrow">¶</a></p>
<span id="name-creating-the-verify-token"></span><div id="make-verifytoken">
<figure id="figure-9">
            <div id="appendix-D.2.5-5.1">
<pre class="lang-pseudocode sourcecode">
| imp_att = TPM_TickStampBlob(
|     keyHandle = restrictedKey_Handle,     /*TPM_KEY_HANDLE*/
|     antiReplay = dummyNonce,              /*TPM_NONCE*/
|     digestToStamp = dummyDigest)          /*TPM_DIGEST*/
|
| VerifyToken = imp_att
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-creating-the-verify-token" class="selfRef">Creating the Verify Token</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="attestation-verification-approach">
<section id="appendix-D.2.6">
          <h4 id="name-attestation-verification-ap">
<a href="#appendix-D.2.6" class="section-number selfRef">D.2.6. </a><a href="#name-attestation-verification-ap" class="section-name selfRef">Attestation Verification Approach</a>
          </h4>
<p id="appendix-D.2.6-1">The seven TUDA information elements transport the essential content that is required to enable
verification of the attestation statement at the Verifier. The following listings illustrate
the verification algorithm to be used at the Verifier in
pseudocode. The pseudocode provided covers the entire verification
task.
If only a subset of TUDA elements changed (see <a href="#updatecycles" class="xref">Section 6.1</a>), only
the corresponding code listings need to be re-executed.<a href="#appendix-D.2.6-1" class="pilcrow">¶</a></p>
<span id="name-verification-of-certificate"></span><div id="verify-Certs">
<figure id="figure-10">
            <div id="appendix-D.2.6-2.1">
<pre class="lang-pseudocode sourcecode">
| TSA_pub = verifyCert(TSA-CA, Cert.TSA-Cert)
| AIK_pub = verifyCert(AIK-CA, Cert.AIK-Cert)
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-verification-of-certificate" class="selfRef">Verification of Certificates</a>
            </figcaption></figure>
</div>
<span id="name-verification-of-synchroniza"></span><div id="verify-sync">
<figure id="figure-11">
            <div id="appendix-D.2.6-3.1">
<pre class="lang-pseudocode sourcecode">
| ts_left = Synctoken.left
| ts_right = Synctoken.right
|
| /* Reconstruct ts_right's omitted values;
|    Alternatively assert == */
| ts_right.currentTicks.tickRate = ts_left.currentTicks.tickRate
| ts_right.currentTicks.tickNonce = ts_left.currentTicks.tickNonce
|
| ticks_left = ts_left.currentTicks
| ticks_right = ts_right.currentTicks
|
| /* Verify Signatures */
| verifySig(AIK_pub, dummyNonce || dummyDigest || ticks_left)
| verifySig(TSA_pub, hash(ts_left) || timestamp.time)
| verifySig(AIK_pub, dummyNonce || hash(timestamp) || ticks_right)
|
| delta_left = timestamp.time -
|   ticks_left.currentTicks * ticks_left.tickRate / 1000
|
| delta_right = timestamp.time -
|   ticks_right.currentTicks * ticks_right.tickRate / 1000
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-verification-of-synchroniza" class="selfRef">Verification of Synchronization Token</a>
            </figcaption></figure>
</div>
<span id="name-verification-of-restriction"></span><div id="verify-restrictioninfo">
<figure id="figure-12">
            <div id="appendix-D.2.6-4.1">
<pre class="lang-pseudocode sourcecode">
| compositeHash = hash_init()
| for value in Composite.values:
|     hash_update(compositeHash, value)
| compositeHash = hash_finish(compositeHash)
|
| certInfo = reconstruct_static(TPM-CERTIFY-INFO)
|
| assert(Composite.bitmask == ExpectedPCRBitmask)
| assert(certInfo.pcrinfo.PCRSelection == Composite.bitmask)
| assert(certInfo.pcrinfo.digestAtRelease == compositeHash)
| assert(certInfo.pubkeyDigest == hash(restrictedKey_Pub))
|
| verifySig(AIK_pub, dummyNonce || certInfo)
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-verification-of-restriction" class="selfRef">Verification of Restriction Info</a>
            </figcaption></figure>
</div>
<span id="name-verification-of-measurement"></span><div id="verify-measurementlog">
<figure id="figure-13">
            <div id="appendix-D.2.6-5.1">
<pre class="lang-pseudocode sourcecode">
| for event in Measurement-Log:
|     if event.pcr not in ExpectedPCRBitmask:
|         continue
|     if event.type == BIOS:
|         assert_whitelist-bios(event.pcr, event.template-hash)
|     if event.type == ima:
|         assert(event.pcr == 10)
|         assert_whitelist(event.pathname, event.filedata-hash)
|         assert(event.template-hash ==
|                hash(event.pathname || event.filedata-hash))
|     if event.type == ima-ng:
|         assert(event.pcr == 10)
|         assert_whitelist-ng(event.pathname, event.filedata-hash)
|         assert(event.template-hash ==
|                hash(event.pathname || event.filedata-hash))
|
|     virtPCR[event.pcr] = hash_extend(virtPCR[event.pcr],
|                                      event.template-hash)
|
| for pcr in ExpectedPCRBitmask:
|     assert(virtPCR[pcr] == Composite.values[i++]
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-verification-of-measurement" class="selfRef">Verification of Measurement Log</a>
            </figcaption></figure>
</div>
<span id="name-verification-of-attestation"></span><div id="verify-attestation">
<figure id="figure-14">
            <div id="appendix-D.2.6-6.1">
<pre class="lang-pseudocode sourcecode">
| ts = Verifytoken
|
| /* Reconstruct ts's omitted values; Alternatively assert == */
| ts.currentTicks.tickRate = ts_left.currentTicks.tickRate
| ts.currentTicks.tickNonce = ts_left.currentTicks.tickNonce
|
| verifySig(restrictedKey_pub, dummyNonce || dummyDigest || ts)
|
| ticks = ts.currentTicks
|
| time_left = delta_right + ticks.currentTicks * ticks.tickRate/1000
| time_right = delta_left + ticks.currentTicks * ticks.tickRate/1000
|
| [time_left, time_right]
</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-verification-of-attestation" class="selfRef">Verification of Attestation Token</a>
            </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="tpm2">
<section id="appendix-D.3">
        <h3 id="name-ie-generation-procedures-for">
<a href="#appendix-D.3" class="section-number selfRef">D.3. </a><a href="#name-ie-generation-procedures-for" class="section-name selfRef">IE Generation Procedures for TPM 2.0</a>
        </h3>
<p id="appendix-D.3-1">The pseudocode below includes general operations that are conducted as specific TPM commands:<a href="#appendix-D.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D.3-2.1">hash() : description TBD<a href="#appendix-D.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-D.3-2.2">sig() : description TBD<a href="#appendix-D.3-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-D.3-2.3">X.509-Certificate() : description TBD<a href="#appendix-D.3-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="appendix-D.3-3">These represent the output structure of that command in the form of a byte string value.<a href="#appendix-D.3-3" class="pilcrow">¶</a></p>
<div id="aik2">
<section id="appendix-D.3.1">
          <h4 id="name-aik-and-aik-certificate-2">
<a href="#appendix-D.3.1" class="section-number selfRef">D.3.1. </a><a href="#name-aik-and-aik-certificate-2" class="section-name selfRef">AIK and AIK Certificate</a>
          </h4>
<p id="appendix-D.3.1-1">Attestations are based upon a cryptographic signature performed by the TPM using
a so-called Attestation Identity Key (AIK). An AIK has the properties that it cannot
be exported from a TPM and is used for attestations. Trust in the AIK is established
by an X.509 Certificate emitted by a Certificate Authority. The AIK certificate is
either provided directly or via a so-called PrivacyCA <span>[<a href="#AIK-Enrollment" class="xref">AIK-Enrollment</a>]</span>.<a href="#appendix-D.3.1-1" class="pilcrow">¶</a></p>
<p id="appendix-D.3.1-2">This element consists of the AIK certificate that includes the AIK's public key used
during verification as well as the certificate chain up to the Root CA for validation
of the AIK certificate itself.<a href="#appendix-D.3.1-2" class="pilcrow">¶</a></p>
<span id="name-tuda-cert-element-for-tpm-2"></span><div id="cert-token2">
<figure id="figure-15">
            <div id="appendix-D.3.1-3.1">
<pre class="lang-pseudocode sourcecode">
TUDA-Cert = [AIK-Cert, TSA-Cert]; maybe split into two for SNMP
AIK-Certificate = X.509-Certificate(AIK-Key,Restricted-Flag)
TSA-Certificate = X.509-Certificate(TSA-Key, TSA-Flag)
</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-tuda-cert-element-for-tpm-2" class="selfRef">TUDA-Cert element for TPM 2.0</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="synchronization-token-1">
<section id="appendix-D.3.2">
          <h4 id="name-synchronization-token-2">
<a href="#appendix-D.3.2" class="section-number selfRef">D.3.2. </a><a href="#name-synchronization-token-2" class="section-name selfRef">Synchronization Token</a>
          </h4>
<p id="appendix-D.3.2-1">The synchronization token uses a different TPM command, TPM2 GetTime() instead of TPM TickStampBlob().  The TPM2 GetTime() command contains the clock and time information of the TPM. The clock information is the equivalent of TUDA v1's tickSession information.<a href="#appendix-D.3.2-1" class="pilcrow">¶</a></p>
<span id="name-tuda-sync-element-for-tpm-2"></span><div id="sync-token2">
<figure id="figure-16">
            <div id="appendix-D.3.2-2.1">
<pre class="lang-pseudocode sourcecode">
TUDA-SyncToken = [
  left_GetTime = sig(AIK-Key,
                     TimeInfo = [
                       time,
                       resetCount,
                       restartCount
                     ]
                    ),
  middle_TimeStamp = sig(TSA-Key,
                         hash(left_TickStampBlob),
                         UTC-localtime
                        ),
  right_TickStampBlob = sig(AIK-Key,
                            hash(middle_TimeStamp),
                            TimeInfo = [
                              time,
                              resetCount,
                              restartCount
                            ]
                           )
]
</pre>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-tuda-sync-element-for-tpm-2" class="selfRef">TUDA-Sync element for TPM 2.0</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="measurement-log">
<section id="appendix-D.3.3">
          <h4 id="name-measurement-log-2">
<a href="#appendix-D.3.3" class="section-number selfRef">D.3.3. </a><a href="#name-measurement-log-2" class="section-name selfRef">Measurement Log</a>
          </h4>
<p id="appendix-D.3.3-1">The creation procedure is identical to <a href="#mlog" class="xref">Appendix D.2.4</a>.<a href="#appendix-D.3.3-1" class="pilcrow">¶</a></p>
<span id="name-tuda-log-element-for-tpm-20"></span><div id="log-token2">
<figure id="figure-17">
            <div id="appendix-D.3.3-2.1">
<pre class="lang-pseudocode sourcecode">
Measurement-Log = [
  * [ EventName,
      PCR-Num,
      Event-Hash ]
]
</pre>
</div>
<figcaption><a href="#figure-17" class="selfRef">Figure 17</a>:
<a href="#name-tuda-log-element-for-tpm-20" class="selfRef">TUDA-Log element for TPM 2.0</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="explicit-time-based-attestation">
<section id="appendix-D.3.4">
          <h4 id="name-explicit-time-based-attesta">
<a href="#appendix-D.3.4" class="section-number selfRef">D.3.4. </a><a href="#name-explicit-time-based-attesta" class="section-name selfRef">Explicit time-based Attestation</a>
          </h4>
<p id="appendix-D.3.4-1">The TUDA attestation token consists of the result of TPM2_Quote() or a set of TPM2_PCR_READ followed by a TPM2_GetSessionAuditDigest. It proves that --- at a certain point-in-time with respect to the TPM's internal clock --- a certain configuration of PCRs was present, as denoted in the keys restriction information.<a href="#appendix-D.3.4-1" class="pilcrow">¶</a></p>
<span id="name-tuda-attest-element-for-tpm"></span><div id="attest-token2">
<figure id="figure-18">
            <div id="appendix-D.3.4-2.1">
<pre class="lang-pseudocode sourcecode">
TUDA-AttestationToken = TUDA-AttestationToken_quote
                      / TUDA-AttestationToken_audit

TUDA-AttestationToken_quote = sig(AIK-Key,
                                  TimeInfo = [
                                    time,
                                    resetCount,
                                    restartCount
                                  ],
                                  PCR-Selection = [ * PCR],
                                  PCR-Digest := PCRDigest
                                 )

TUDA-AttestationToken_audit = sig(AIK-key,
                                  TimeInfo = [
                                    time,
                                    resetCount,
                                    restartCount
                                  ],
                                  Session-Digest := PCRDigest
                                 )
</pre>
</div>
<figcaption><a href="#figure-18" class="selfRef">Figure 18</a>:
<a href="#name-tuda-attest-element-for-tpm" class="selfRef">TUDA-Attest element for TPM 2.0</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="sync-proof">
<section id="appendix-D.3.5">
          <h4 id="name-sync-proof">
<a href="#appendix-D.3.5" class="section-number selfRef">D.3.5. </a><a href="#name-sync-proof" class="section-name selfRef">Sync Proof</a>
          </h4>
<p id="appendix-D.3.5-1">In order to proof to the Verifier that the TPM's clock was not 'fast-forwarded' the result of a TPM2_GetTime() is sent after the TUDA-AttestationToken.<a href="#appendix-D.3.5-1" class="pilcrow">¶</a></p>
<span id="name-tuda-proof-element-for-tpm-"></span><div id="prrof-token2">
<figure id="figure-19">
            <div id="appendix-D.3.5-2.1">
<pre class="lang-pseudocode sourcecode">
TUDA-SyncProof = sig(AIK-Key,
                     TimeInfo = [
                       time,
                       resetCount,
                       restartCount
                     ]
                    ),
</pre>
</div>
<figcaption><a href="#figure-19" class="selfRef">Figure 19</a>:
<a href="#name-tuda-proof-element-for-tpm-" class="selfRef">TUDA-Proof element for TPM 2.0</a>
            </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-E">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-F">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Andreas Fuchs</span></div>
<div dir="auto" class="left"><span class="org">Fraunhofer Institute for Secure Information Technology</span></div>
<div dir="auto" class="left"><span class="street-address">Rheinstrasse 75</span></div>
<div dir="auto" class="left">
<span class="postal-code">64295</span> <span class="locality">Darmstadt</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:andreas.fuchs@sit.fraunhofer.de" class="email">andreas.fuchs@sit.fraunhofer.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Henk Birkholz</span></div>
<div dir="auto" class="left"><span class="org">Fraunhofer Institute for Secure Information Technology</span></div>
<div dir="auto" class="left"><span class="street-address">Rheinstrasse 75</span></div>
<div dir="auto" class="left">
<span class="postal-code">64295</span> <span class="locality">Darmstadt</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:henk.birkholz@sit.fraunhofer.de" class="email">henk.birkholz@sit.fraunhofer.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Ira E McDonald</span></div>
<div dir="auto" class="left"><span class="org">High North Inc</span></div>
<div dir="auto" class="left"><span class="street-address">PO Box 221</span></div>
<div dir="auto" class="left">
<span class="locality">Grand Marais</span>,  <span class="postal-code">49839</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:blueroofmusic@gmail.com" class="email">blueroofmusic@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Carsten Bormann</span></div>
<div dir="auto" class="left"><span class="org">Universität Bremen TZI</span></div>
<div dir="auto" class="left"><span class="street-address">Bibliothekstr. 1</span></div>
<div dir="auto" class="left">
<span class="postal-code">D-28359</span> <span class="locality">Bremen</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+49-421-218-63921" class="tel">+49-421-218-63921</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:cabo@tzi.org" class="email">cabo@tzi.org</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
